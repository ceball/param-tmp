<!DOCTYPE html>
<html lang="en">
 <head>
  <!-- Basic Page Needs
  –––––––––––––––––––––––––––––––––––––––––––––––––– -->
  <meta charset="utf-8"/>
  <title>
   param.__init__ — Param 1.7.0.post15+gc6105c8 documentation
  </title>
  <meta content="Declarative Python programming using Parameters." name="description"/>
  <meta content="PyViz authors" name="author"/>
  <!-- Mobile Specific Metas
  –––––––––––––––––––––––––––––––––––––––––––––––––– -->
  <meta content="width=device-width, initial-scale=1" name="viewport"/>
  <!-- FONT
  –––––––––––––––––––––––––––––––––––––––––––––––––– -->
  <script src="https://ajax.googleapis.com/ajax/libs/webfont/1.6.16/webfont.js">
  </script>
  <script>
   WebFont.load({
      google: {
        families: ['Source Sans Pro']
      }
    });
  </script>
  <!-- CSS
  –––––––––––––––––––––––––––––––––––––––––––––––––– -->
  <link href="../../_static/css/main.css" rel="stylesheet"/>
  <link href="../../_static/nbsite.css" rel="stylesheet"/>
  <!-- Scripts
  –––––––––––––––––––––––––––––––––––––––––––––––––– -->
  <script src="//ajax.googleapis.com/ajax/libs/jquery/2.1.1/jquery.min.js">
  </script>
  <script async="" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-MML-AM_CHTML" type="text/javascript">
  </script>
  <script src="../../_static/js/main.js">
  </script>
  <script src="../../_static/nbsite.js">
  </script>
  <script src="../../_static/require.js">
  </script>
  <!-- Favicon
  –––––––––––––––––––––––––––––––––––––––––––––––––– -->
  <link href="../../_static/favicon.ico" rel="icon" type="image/png"/>
  <!-- Canonical
  –––––––––––––––––––––––––––––––––––––––––––––––––– -->
  <link href="/_modules/param/__init__.html" rel="canonical"/>
 </head>
 <body class="">
  <header class="navigation">
   <div class="wrapper">
    <a class="logo" href="../../index.html">
     <img alt="Logo" src="../../_static/logo.png"/>
    </a>
    <a class="navigation-menu logo-text" href="../../index.html">
     Param
    </a>
    <a class="navigation-menu-button" href="javascript:void(0)" id="js-mobile-menu">
     Menu
    </a>
    <nav>
     <ul class="navigation-menu show" id="js-navigation-menu">
      <li class="nav-link">
       <a href="../../Reference_Manual/param.html">
        API
       </a>
      </li>
      <li class="nav-link">
       <a href="../../About.html">
        About
       </a>
      </li>
      <li class="nav-link">
       <div style="display:inline-block;vertical-align: middle;">
        <div class="search-bar">
         <form action="../../search.html" method="get" role="search">
          <input name="q" placeholder="Search" type="search"/>
          <button type="submit">
           <img alt="Search Icon" src="https://raw.githubusercontent.com/thoughtbot/refills/master/source/images/search-icon-black.png"/>
          </button>
         </form>
        </div>
       </div>
      </li>
     </ul>
    </nav>
   </div>
  </header>
  <!-- MAIN BODY OF DOCS –––––––––––––––––– -->
  <div class="docs section">
   <div id="hacketyhackhack">
    <!-- style="width:20%;margin-right: 100px;"> -->
    <!--style="display: none;"> style="display:none;"> -->
    <div class="toc" style="width:15%; margin-right:20px;">
     <ul>
      <li class="toctree-l1">
       <a class="reference internal" href="../../index.html">
        Introduction
       </a>
      </li>
      <li class="toctree-l1">
       <a class="reference internal" href="../../Reference_Manual/param.html">
        API
       </a>
      </li>
      <li class="toctree-l1">
       <a class="reference internal" href="../../About.html">
        About
       </a>
      </li>
     </ul>
    </div>
   </div>
   <div class="content">
    <!-- style="max-width:80%;margin-left:auto;margin-right: auto;">-->
    <h1>
     Source code for param.__init__
    </h1>
    <div class="highlight">
     <pre><span></span><span class="sd">"""</span>
<span class="sd">Parameters are a kind of class attribute allowing special behavior,</span>
<span class="sd">including dynamically generated parameter values, documentation</span>
<span class="sd">strings, constant and read-only parameters, and type or range checking</span>
<span class="sd">at assignment time.</span>

<span class="sd">Potentially useful for any large Python program that needs</span>
<span class="sd">user-modifiable object attributes; see the Parameter and Parameterized</span>
<span class="sd">classes for more information.  If you do not want to add a dependency</span>
<span class="sd">on external code by importing from a separately installed param</span>
<span class="sd">package, you can simply save this file as param.py and copy it and</span>
<span class="sd">parameterized.py directly into your own package.</span>

<span class="sd">This file contains subclasses of Parameter, implementing specific</span>
<span class="sd">parameter types (e.g. Number), and also imports the definition of</span>
<span class="sd">Parameters and Parameterized classes.</span>
<span class="sd">"""</span>

<span class="kn">import</span> <span class="nn">os.path</span>
<span class="kn">import</span> <span class="nn">sys</span>
<span class="kn">import</span> <span class="nn">glob</span>
<span class="kn">import</span> <span class="nn">re</span>
<span class="kn">import</span> <span class="nn">datetime</span> <span class="k">as</span> <span class="nn">dt</span>

<span class="kn">from</span> <span class="nn">.parameterized</span> <span class="k">import</span> <span class="n">Parameterized</span><span class="p">,</span> <span class="n">Parameter</span><span class="p">,</span> <span class="n">String</span><span class="p">,</span> \
     <span class="n">descendents</span><span class="p">,</span> <span class="n">ParameterizedFunction</span><span class="p">,</span> <span class="n">ParamOverrides</span>

<span class="kn">from</span> <span class="nn">.parameterized</span> <span class="k">import</span> <span class="n">logging_level</span>     <span class="c1"># noqa: api import</span>
<span class="kn">from</span> <span class="nn">.parameterized</span> <span class="k">import</span> <span class="n">shared_parameters</span> <span class="c1"># noqa: api import</span>

<span class="kn">from</span> <span class="nn">collections</span> <span class="k">import</span> <span class="n">OrderedDict</span>


<span class="c1"># Determine up-to-date version information, if possible, but with a</span>
<span class="c1"># safe fallback to ensure that this file and parameterized.py are the</span>
<span class="c1"># only two required files.</span>
<span class="k">try</span><span class="p">:</span>
    <span class="kn">from</span> <span class="nn">.version</span> <span class="k">import</span> <span class="n">Version</span>
    <span class="n">__version__</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">Version</span><span class="p">(</span><span class="n">fpath</span><span class="o">=</span><span class="vm">__file__</span><span class="p">,</span> <span class="n">archive_commit</span><span class="o">=</span><span class="s2">"$Format:%h$"</span><span class="p">,</span> <span class="n">reponame</span><span class="o">=</span><span class="s2">"param"</span><span class="p">))</span>
<span class="k">except</span><span class="p">:</span>
    <span class="n">__version__</span> <span class="o">=</span> <span class="s2">"0.0.0+unknown"</span>


<span class="n">dt_types</span> <span class="o">=</span> <span class="p">(</span><span class="n">dt</span><span class="o">.</span><span class="n">datetime</span><span class="p">,)</span>

<span class="k">try</span><span class="p">:</span>
    <span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
    <span class="n">dt_types</span> <span class="o">=</span> <span class="n">dt_types</span> <span class="o">+</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">datetime64</span><span class="p">,)</span>
<span class="k">except</span><span class="p">:</span>
    <span class="k">pass</span>

<span class="k">if</span> <span class="n">sys</span><span class="o">.</span><span class="n">version_info</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">&gt;=</span> <span class="mi">3</span><span class="p">:</span>
    <span class="n">unicode</span> <span class="o">=</span> <span class="nb">str</span>

<span class="c1">#: Top-level object to allow messaging not tied to a particular</span>
<span class="c1">#: Parameterized object, as in 'param.main.warning("Invalid option")'.</span>
<span class="n">main</span><span class="o">=</span><span class="n">Parameterized</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">"main"</span><span class="p">)</span>


<span class="c1"># A global random seed (integer or rational) available for controlling</span>
<span class="c1"># the behaviour of parameterized objects with random state.</span>
<span class="n">random_seed</span> <span class="o">=</span> <span class="mi">42</span>


<div class="viewcode-block" id="produce_value"><a class="viewcode-back" href="../../Reference_Manual/param.html#param.__init__.produce_value">[docs]</a><span class="k">def</span> <span class="nf">produce_value</span><span class="p">(</span><span class="n">value_obj</span><span class="p">):</span>
    <span class="sd">"""</span>
<span class="sd">    A helper function that produces an actual parameter from a stored</span>
<span class="sd">    object: if the object is callable, call it, otherwise return the</span>
<span class="sd">    object.</span>
<span class="sd">    """</span>
    <span class="k">if</span> <span class="n">callable</span><span class="p">(</span><span class="n">value_obj</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">value_obj</span><span class="p">()</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">value_obj</span></div>


<div class="viewcode-block" id="as_unicode"><a class="viewcode-back" href="../../Reference_Manual/param.html#param.__init__.as_unicode">[docs]</a><span class="k">def</span> <span class="nf">as_unicode</span><span class="p">(</span><span class="n">obj</span><span class="p">):</span>
    <span class="sd">"""</span>
<span class="sd">    Safely casts any object to unicode including regular string</span>
<span class="sd">    (i.e. bytes) types in python 2.</span>
<span class="sd">    """</span>
    <span class="k">if</span> <span class="n">sys</span><span class="o">.</span><span class="n">version_info</span><span class="o">.</span><span class="n">major</span> <span class="o">&lt;</span> <span class="mi">3</span> <span class="ow">and</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
        <span class="n">obj</span> <span class="o">=</span> <span class="n">obj</span><span class="o">.</span><span class="n">decode</span><span class="p">(</span><span class="s1">'utf-8'</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">unicode</span><span class="p">(</span><span class="n">obj</span><span class="p">)</span></div>


<div class="viewcode-block" id="named_objs"><a class="viewcode-back" href="../../Reference_Manual/param.html#param.__init__.named_objs">[docs]</a><span class="k">def</span> <span class="nf">named_objs</span><span class="p">(</span><span class="n">objlist</span><span class="p">):</span>
    <span class="sd">"""</span>
<span class="sd">    Given a list of objects, returns a dictionary mapping from</span>
<span class="sd">    string name for the object to the object itself.</span>
<span class="sd">    """</span>
    <span class="n">objs</span> <span class="o">=</span> <span class="n">OrderedDict</span><span class="p">()</span>
    <span class="k">for</span> <span class="n">obj</span> <span class="ow">in</span> <span class="n">objlist</span><span class="p">:</span>
        <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span> <span class="s2">"name"</span><span class="p">):</span>
            <span class="n">k</span> <span class="o">=</span> <span class="n">obj</span><span class="o">.</span><span class="n">name</span>
        <span class="k">elif</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span> <span class="s1">'__name__'</span><span class="p">):</span>
            <span class="n">k</span> <span class="o">=</span> <span class="n">obj</span><span class="o">.</span><span class="vm">__name__</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">k</span> <span class="o">=</span> <span class="n">as_unicode</span><span class="p">(</span><span class="n">obj</span><span class="p">)</span>
        <span class="n">objs</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="n">obj</span>
    <span class="k">return</span> <span class="n">objs</span></div>



<div class="viewcode-block" id="Infinity"><a class="viewcode-back" href="../../Reference_Manual/param.html#param.__init__.Infinity">[docs]</a><span class="k">class</span> <span class="nc">Infinity</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
    <span class="sd">"""</span>
<span class="sd">    An instance of this class represents an infinite value. Unlike</span>
<span class="sd">    Python's float('inf') value, this object can be safely compared</span>
<span class="sd">    with gmpy numeric types across different gmpy versions.</span>

<span class="sd">    All operators on Infinity() return Infinity(), apart from the</span>
<span class="sd">    comparison and equality operators. Equality works by checking</span>
<span class="sd">    whether the two objects are both instances of this class.</span>
<span class="sd">    """</span>

    <span class="k">def</span> <span class="nf">__eq__</span>  <span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">other</span><span class="p">):</span> <span class="k">return</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">other</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="p">)</span>
    <span class="k">def</span> <span class="nf">__ne__</span>  <span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">other</span><span class="p">):</span> <span class="k">return</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">==</span><span class="n">other</span>
    <span class="k">def</span> <span class="nf">__lt__</span>  <span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">other</span><span class="p">):</span> <span class="k">return</span> <span class="kc">False</span>
    <span class="k">def</span> <span class="nf">__le__</span>  <span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">other</span><span class="p">):</span> <span class="k">return</span> <span class="kc">False</span>
    <span class="k">def</span> <span class="nf">__gt__</span>  <span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">other</span><span class="p">):</span> <span class="k">return</span> <span class="kc">True</span>
    <span class="k">def</span> <span class="nf">__ge__</span>  <span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">other</span><span class="p">):</span> <span class="k">return</span> <span class="kc">True</span>
    <span class="k">def</span> <span class="nf">__add__</span> <span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">other</span><span class="p">):</span> <span class="k">return</span> <span class="bp">self</span>
    <span class="k">def</span> <span class="nf">__radd__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">other</span><span class="p">):</span> <span class="k">return</span> <span class="bp">self</span>
    <span class="k">def</span> <span class="nf">__ladd__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">other</span><span class="p">):</span> <span class="k">return</span> <span class="bp">self</span>
    <span class="k">def</span> <span class="nf">__sub__</span> <span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">other</span><span class="p">):</span> <span class="k">return</span> <span class="bp">self</span>
    <span class="k">def</span> <span class="nf">__iadd_</span> <span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">other</span><span class="p">):</span> <span class="k">return</span> <span class="bp">self</span>
    <span class="k">def</span> <span class="nf">__isub__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">other</span><span class="p">):</span> <span class="k">return</span> <span class="bp">self</span>
    <span class="k">def</span> <span class="nf">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>       <span class="k">return</span> <span class="s2">"Infinity()"</span>
    <span class="k">def</span> <span class="nf">__str__</span> <span class="p">(</span><span class="bp">self</span><span class="p">):</span>       <span class="k">return</span> <span class="nb">repr</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span></div>



<div class="viewcode-block" id="Time"><a class="viewcode-back" href="../../Reference_Manual/param.html#param.__init__.Time">[docs]</a><span class="k">class</span> <span class="nc">Time</span><span class="p">(</span><span class="n">Parameterized</span><span class="p">):</span>
    <span class="sd">"""</span>
<span class="sd">    A callable object returning a number for the current time.</span>

<span class="sd">    Here 'time' is an abstract concept that can be interpreted in any</span>
<span class="sd">    useful way.  For instance, in a simulation, it would be the</span>
<span class="sd">    current simulation time, while in a turn-taking game it could be</span>
<span class="sd">    the number of moves so far.  The key intended usage is to allow</span>
<span class="sd">    independent Parameterized objects with Dynamic parameters to</span>
<span class="sd">    remain consistent with a global reference.</span>

<span class="sd">    The time datatype (time_type) is configurable, but should</span>
<span class="sd">    typically be an exact numeric type like an integer or a rational,</span>
<span class="sd">    so that small floating-point errors do not accumulate as time is</span>
<span class="sd">    incremented repeatedly.</span>

<span class="sd">    When used as a context manager using the 'with' statement</span>
<span class="sd">    (implemented by the __enter__ and __exit__ special methods), entry</span>
<span class="sd">    into a context pushes the state of the Time object, allowing the</span>
<span class="sd">    effect of changes to the time value to be explored by setting,</span>
<span class="sd">    incrementing or decrementing time as desired. This allows the</span>
<span class="sd">    state of time-dependent objects to be modified temporarily as a</span>
<span class="sd">    function of time, within the context's block. For instance, you</span>
<span class="sd">    could use the context manager to "see into the future" to collect</span>
<span class="sd">    data over multiple times, without affecting the global time state</span>
<span class="sd">    once exiting the context. Of course, you need to be careful not to</span>
<span class="sd">    do anything while in context that would affect the lasting state</span>
<span class="sd">    of your other objects, if you want things to return to their</span>
<span class="sd">    starting state when exiting the context.</span>

<span class="sd">    The starting time value of a new Time object is 0, converted to</span>
<span class="sd">    the chosen time type. Here is an illustration of how time can be</span>
<span class="sd">    manipulated using a Time object:</span>

<span class="sd">    &gt;&gt;&gt; time = Time(until=20, timestep=1)</span>
<span class="sd">    &gt;&gt;&gt; 'The initial time is %s' % time()</span>
<span class="sd">    'The initial time is 0'</span>
<span class="sd">    &gt;&gt;&gt; 'Setting the time to %s' % time(5)</span>
<span class="sd">    'Setting the time to 5'</span>
<span class="sd">    &gt;&gt;&gt; time += 5</span>
<span class="sd">    &gt;&gt;&gt; 'After incrementing by 5, the time is %s' % time()</span>
<span class="sd">    'After incrementing by 5, the time is 10'</span>
<span class="sd">    &gt;&gt;&gt; with time as t:  # Entering a context</span>
<span class="sd">    ...     'Time before iteration: %s' % t()</span>
<span class="sd">    ...     'Iteration: %s' % [val for val in t]</span>
<span class="sd">    ...     'Time after iteration: %s' % t()</span>
<span class="sd">    ...     t += 2</span>
<span class="sd">    ...     'The until parameter may be exceeded outside iteration: %s' % t()</span>
<span class="sd">    'Time before iteration: 10'</span>
<span class="sd">    'Iteration: [10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20]'</span>
<span class="sd">    'Time after iteration: 20'</span>
<span class="sd">    'The until parameter may be exceeded outside iteration: 22'</span>
<span class="sd">    &gt;&gt;&gt; 'After exiting the context the time is back to %s' % time()</span>
<span class="sd">    'After exiting the context the time is back to 10'</span>
<span class="sd">    """</span>

    <span class="n">_infinitely_iterable</span> <span class="o">=</span> <span class="kc">True</span>

    <span class="n">forever</span> <span class="o">=</span> <span class="n">Infinity</span><span class="p">()</span>

    <span class="n">label</span><span class="o">=</span> <span class="n">String</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="s1">'Time'</span><span class="p">,</span> <span class="n">doc</span><span class="o">=</span><span class="s2">"""</span>
<span class="s2">         The label given to the Time object. Can be used to convey</span>
<span class="s2">         more specific notions of time as appropriate. For instance,</span>
<span class="s2">         the label could be 'Simulation Time' or 'Duration'."""</span><span class="p">)</span>


    <span class="n">time_type</span> <span class="o">=</span> <span class="n">Parameter</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="nb">int</span><span class="p">,</span> <span class="n">constant</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">doc</span><span class="o">=</span><span class="s2">"""</span>
<span class="s2">        Callable that Time will use to convert user-specified time</span>
<span class="s2">        values into the current time; all times will be of the resulting</span>
<span class="s2">        numeric type.</span>

<span class="s2">        By default, time is of integer type, but you can supply any</span>
<span class="s2">        arbitrary-precision type like a fixed-point decimal or a</span>
<span class="s2">        rational, to allow fractional times.  Floating-point times are</span>
<span class="s2">        also allowed, but are not recommended because they will suffer</span>
<span class="s2">        from accumulated rounding errors.  For instance, incrementing</span>
<span class="s2">        a floating-point value 0.0 by 0.05, 20 times, will not reach</span>
<span class="s2">        1.0 exactly.  Instead, it will be slightly higher than 1.0,</span>
<span class="s2">        because 0.05 cannot be represented exactly in a standard</span>
<span class="s2">        floating point numeric type. Fixed-point or rational types</span>
<span class="s2">        should be able to handle such computations exactly, avoiding</span>
<span class="s2">        accumulation issues over long time intervals.</span>

<span class="s2">        Some potentially useful exact number classes:</span>

<span class="s2">         - int: Suitable if all times can be expressed as integers.</span>

<span class="s2">         - Python's decimal.Decimal and fractions.Fraction classes:</span>
<span class="s2">           widely available but slow and also awkward to specify times</span>
<span class="s2">           (e.g. cannot simply type 0.05, but have to use a special</span>
<span class="s2">           constructor or a string).</span>

<span class="s2">         - fixedpoint.FixedPoint: Allows a natural representation of</span>
<span class="s2">           times in decimal notation, but very slow and needs to be</span>
<span class="s2">           installed separately.</span>

<span class="s2">         - gmpy.mpq: Allows a natural representation of times in</span>
<span class="s2">           decimal notation, and very fast because it uses the GNU</span>
<span class="s2">           Multi-Precision library, but needs to be installed</span>
<span class="s2">           separately and depends on a non-Python library.  gmpy.mpq</span>
<span class="s2">           is gmpy's rational type.</span>
<span class="s2">        """</span><span class="p">)</span>

    <span class="n">timestep</span> <span class="o">=</span> <span class="n">Parameter</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span><span class="n">doc</span><span class="o">=</span><span class="s2">"""</span>
<span class="s2">        Stepsize to be used with the iterator interface.</span>
<span class="s2">        Time can be advanced or decremented by any value, not just</span>
<span class="s2">        those corresponding to the stepsize, and so this value is only</span>
<span class="s2">        a default."""</span><span class="p">)</span>

    <span class="n">until</span> <span class="o">=</span> <span class="n">Parameter</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="n">forever</span><span class="p">,</span><span class="n">doc</span><span class="o">=</span><span class="s2">"""</span>
<span class="s2">         Declaration of an expected end to time values, if any.  When</span>
<span class="s2">         using the iterator interface, iteration will end before this</span>
<span class="s2">         value is exceeded."""</span><span class="p">)</span>

    <span class="n">unit</span> <span class="o">=</span> <span class="n">String</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">doc</span><span class="o">=</span><span class="s2">"""</span>
<span class="s2">        The units of the time dimensions. The default of None is set</span>
<span class="s2">        as the global time function may on an arbitrary time base.</span>

<span class="s2">        Typical values for the parameter are 'seconds' (the SI unit</span>
<span class="s2">        for time) or subdivisions thereof (e.g. 'milliseconds')."""</span><span class="p">)</span>


    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">params</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">Time</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="o">**</span><span class="n">params</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_time</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">time_type</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_exhausted</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_pushed_state</span> <span class="o">=</span> <span class="p">[]</span>


    <span class="k">def</span> <span class="nf">__eq__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="n">Time</span><span class="p">):</span>
            <span class="k">return</span> <span class="kc">False</span>
        <span class="n">self_params</span> <span class="o">=</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">timestep</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">until</span><span class="p">)</span>
        <span class="n">other_params</span> <span class="o">=</span> <span class="p">(</span><span class="n">other</span><span class="o">.</span><span class="n">timestep</span><span class="p">,</span><span class="n">other</span><span class="o">.</span><span class="n">until</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">self_params</span> <span class="o">!=</span> <span class="n">other_params</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">False</span>
        <span class="k">return</span> <span class="kc">True</span>


    <span class="k">def</span> <span class="nf">__ne__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
        <span class="k">return</span> <span class="ow">not</span> <span class="p">(</span><span class="bp">self</span> <span class="o">==</span> <span class="n">other</span><span class="p">)</span>


    <span class="k">def</span> <span class="nf">__iter__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span> <span class="k">return</span> <span class="bp">self</span>


    <span class="k">def</span> <span class="nf">__next__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">timestep</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">time_type</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">timestep</span><span class="p">)</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_exhausted</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_exhausted</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="k">elif</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_time</span> <span class="o">+</span> <span class="n">timestep</span><span class="p">)</span> <span class="o">&lt;=</span> <span class="bp">self</span><span class="o">.</span><span class="n">until</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_time</span> <span class="o">+=</span> <span class="n">timestep</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_exhausted</span> <span class="o">=</span> <span class="kc">None</span>
            <span class="k">raise</span> <span class="ne">StopIteration</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_time</span>

    <span class="c1"># For Python 2 compatibility; can be removed for Python 3.</span>
    <span class="nb">next</span> <span class="o">=</span> <span class="fm">__next__</span>

    <span class="k">def</span> <span class="nf">__call__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">val</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">time_type</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">"""</span>
<span class="sd">        When called with no arguments, returns the current time value.</span>

<span class="sd">        When called with a specified val, sets the time to it.</span>

<span class="sd">        When called with a specified time_type, changes the time_type</span>
<span class="sd">        and sets the current time to the given val (which *must* be</span>
<span class="sd">        specified) converted to that time type.  To ensure that</span>
<span class="sd">        the current state remains consistent, this is normally the only</span>
<span class="sd">        way to change the time_type of an existing Time instance.</span>
<span class="sd">        """</span>

        <span class="k">if</span> <span class="n">time_type</span> <span class="ow">and</span> <span class="n">val</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s2">"Please specify a value for the new time_type."</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">time_type</span><span class="p">:</span>
            <span class="n">type_param</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">param</span><span class="o">.</span><span class="n">params</span><span class="p">(</span><span class="s1">'time_type'</span><span class="p">)</span>
            <span class="n">type_param</span><span class="o">.</span><span class="n">constant</span> <span class="o">=</span> <span class="kc">False</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">time_type</span> <span class="o">=</span> <span class="n">time_type</span>
            <span class="n">type_param</span><span class="o">.</span><span class="n">constant</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="k">if</span> <span class="n">val</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_time</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">time_type</span><span class="p">(</span><span class="n">val</span><span class="p">)</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_time</span>


    <span class="k">def</span> <span class="nf">advance</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">val</span><span class="p">):</span>
        <span class="bp">self</span> <span class="o">+=</span> <span class="n">val</span>


    <span class="k">def</span> <span class="nf">__iadd__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_time</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_time</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">time_type</span><span class="p">(</span><span class="n">other</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span>


    <span class="k">def</span> <span class="nf">__isub__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_time</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_time</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">time_type</span><span class="p">(</span><span class="n">other</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span>


    <span class="k">def</span> <span class="nf">__enter__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">"""Enter the context and push the current state."""</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_pushed_state</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="bp">self</span><span class="o">.</span><span class="n">_time</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">timestep</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">until</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">in_context</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="k">return</span> <span class="bp">self</span>


    <span class="k">def</span> <span class="nf">__exit__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">exc</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">):</span>
        <span class="sd">"""</span>
<span class="sd">        Exit from the current context, restoring the previous state.</span>
<span class="sd">        The StopIteration exception raised in context will force the</span>
<span class="sd">        context to exit. Any other exception exc that is raised in the</span>
<span class="sd">        block will not be caught.</span>
<span class="sd">        """</span>
        <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_time</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">timestep</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">until</span><span class="p">)</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_pushed_state</span><span class="o">.</span><span class="n">pop</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">in_context</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_pushed_state</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">0</span>
        <span class="k">if</span> <span class="n">exc</span> <span class="ow">is</span> <span class="ne">StopIteration</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">True</span></div>



<div class="viewcode-block" id="Dynamic"><a class="viewcode-back" href="../../Reference_Manual/param.html#param.__init__.Dynamic">[docs]</a><span class="k">class</span> <span class="nc">Dynamic</span><span class="p">(</span><span class="n">Parameter</span><span class="p">):</span>
    <span class="sd">"""</span>
<span class="sd">    Parameter whose value can be generated dynamically by a callable</span>
<span class="sd">    object.</span>

<span class="sd">    If a Parameter is declared as Dynamic, it can be set a callable</span>
<span class="sd">    object (such as a function or callable class), and getting the</span>
<span class="sd">    parameter's value will call that callable.</span>

<span class="sd">    Note that at present, the callable object must allow attributes</span>
<span class="sd">    to be set on itself.</span>

<span class="sd">    [Python 2.4 limitation: the callable object must be an instance of a</span>
<span class="sd">    callable class, rather than a named function or a lambda function,</span>
<span class="sd">    otherwise the object will not be picklable or deepcopyable.]</span>

<span class="sd">    If set as time_dependent, setting the Dynamic.time_fn allows the</span>
<span class="sd">    production of dynamic values to be controlled: a new value will be</span>
<span class="sd">    produced only if the current value of time_fn is different from</span>
<span class="sd">    what it was the last time the parameter value was requested.</span>

<span class="sd">    By default, the Dynamic parameters are not time_dependent so that</span>
<span class="sd">    new values are generated on every call regardless of the time. The</span>
<span class="sd">    default time_fn used when time_dependent is a single Time instance</span>
<span class="sd">    that allows general manipulations of time. It may be set to some</span>
<span class="sd">    other callable as required so long as a number is returned on each</span>
<span class="sd">    call.</span>
<span class="sd">    """</span>

    <span class="n">time_fn</span> <span class="o">=</span> <span class="n">Time</span><span class="p">()</span>
    <span class="n">time_dependent</span> <span class="o">=</span> <span class="kc">False</span>

    <span class="c1"># CBENHANCEMENT: Add an 'epsilon' slot.</span>
    <span class="c1"># See email 'Re: simulation-time-controlled Dynamic parameters'</span>
    <span class="c1"># Dec 22, 2007 CB-&gt;JAB</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="o">**</span><span class="n">params</span><span class="p">):</span>
        <span class="sd">"""</span>
<span class="sd">        Call the superclass's __init__ and set instantiate=True if the</span>
<span class="sd">        default is dynamic.</span>
<span class="sd">        """</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">Dynamic</span><span class="p">,</span><span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="o">**</span><span class="n">params</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">callable</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">default</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_set_instantiate</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_initialize_generator</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">default</span><span class="p">)</span>


    <span class="k">def</span> <span class="nf">_initialize_generator</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">gen</span><span class="p">,</span><span class="n">obj</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">"""</span>
<span class="sd">        Add 'last time' and 'last value' attributes to the generator.</span>
<span class="sd">        """</span>
        <span class="c1"># CEBALERT: use a dictionary to hold these things.</span>
        <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span><span class="s2">"_Dynamic_time_fn"</span><span class="p">):</span>
            <span class="n">gen</span><span class="o">.</span><span class="n">_Dynamic_time_fn</span> <span class="o">=</span> <span class="n">obj</span><span class="o">.</span><span class="n">_Dynamic_time_fn</span>

        <span class="n">gen</span><span class="o">.</span><span class="n">_Dynamic_last</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="c1"># CEB: I'd use None for this, except can't compare a fixedpoint</span>
        <span class="c1"># number with None (e.g. 1&gt;None but FixedPoint(1)&gt;None can't be done)</span>
        <span class="n">gen</span><span class="o">.</span><span class="n">_Dynamic_time</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>

        <span class="n">gen</span><span class="o">.</span><span class="n">_saved_Dynamic_last</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">gen</span><span class="o">.</span><span class="n">_saved_Dynamic_time</span> <span class="o">=</span> <span class="p">[]</span>


    <span class="k">def</span> <span class="nf">__get__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">obj</span><span class="p">,</span><span class="n">objtype</span><span class="p">):</span>
        <span class="sd">"""</span>
<span class="sd">        Call the superclass's __get__; if the result is not dynamic</span>
<span class="sd">        return that result, otherwise ask that result to produce a</span>
<span class="sd">        value and return it.</span>
<span class="sd">        """</span>
        <span class="n">gen</span> <span class="o">=</span> <span class="nb">super</span><span class="p">(</span><span class="n">Dynamic</span><span class="p">,</span><span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__get__</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span><span class="n">objtype</span><span class="p">)</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">gen</span><span class="p">,</span><span class="s1">'_Dynamic_last'</span><span class="p">):</span>
            <span class="k">return</span> <span class="n">gen</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_produce_value</span><span class="p">(</span><span class="n">gen</span><span class="p">)</span>


    <span class="k">def</span> <span class="nf">__set__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">obj</span><span class="p">,</span><span class="n">val</span><span class="p">):</span>
        <span class="sd">"""</span>
<span class="sd">        Call the superclass's set and keep this parameter's</span>
<span class="sd">        instantiate value up to date (dynamic parameters</span>
<span class="sd">        must be instantiated).</span>

<span class="sd">        If val is dynamic, initialize it as a generator.</span>
<span class="sd">        """</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">Dynamic</span><span class="p">,</span><span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__set__</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span><span class="n">val</span><span class="p">)</span>

        <span class="n">dynamic</span> <span class="o">=</span> <span class="n">callable</span><span class="p">(</span><span class="n">val</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">dynamic</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_initialize_generator</span><span class="p">(</span><span class="n">val</span><span class="p">,</span><span class="n">obj</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">obj</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_set_instantiate</span><span class="p">(</span><span class="n">dynamic</span><span class="p">)</span>


    <span class="k">def</span> <span class="nf">_produce_value</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">gen</span><span class="p">,</span><span class="n">force</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        <span class="sd">"""</span>
<span class="sd">        Return a value from gen.</span>

<span class="sd">        If there is no time_fn, then a new value will be returned</span>
<span class="sd">        (i.e. gen will be asked to produce a new value).</span>

<span class="sd">        If force is True, or the value of time_fn() is different from</span>
<span class="sd">        what it was was last time produce_value was called, a new</span>
<span class="sd">        value will be produced and returned. Otherwise, the last value</span>
<span class="sd">        gen produced will be returned.</span>
<span class="sd">        """</span>

        <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">gen</span><span class="p">,</span><span class="s2">"_Dynamic_time_fn"</span><span class="p">):</span>
            <span class="n">time_fn</span> <span class="o">=</span> <span class="n">gen</span><span class="o">.</span><span class="n">_Dynamic_time_fn</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">time_fn</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">time_fn</span>

        <span class="k">if</span> <span class="p">(</span><span class="n">time_fn</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">)</span> <span class="ow">or</span> <span class="p">(</span><span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">time_dependent</span><span class="p">):</span>
            <span class="n">value</span> <span class="o">=</span> <span class="n">produce_value</span><span class="p">(</span><span class="n">gen</span><span class="p">)</span>
            <span class="n">gen</span><span class="o">.</span><span class="n">_Dynamic_last</span> <span class="o">=</span> <span class="n">value</span>
        <span class="k">else</span><span class="p">:</span>

            <span class="n">time</span> <span class="o">=</span> <span class="n">time_fn</span><span class="p">()</span>

            <span class="k">if</span> <span class="n">force</span> <span class="ow">or</span> <span class="n">time</span><span class="o">!=</span><span class="n">gen</span><span class="o">.</span><span class="n">_Dynamic_time</span><span class="p">:</span>
                <span class="n">value</span> <span class="o">=</span> <span class="n">produce_value</span><span class="p">(</span><span class="n">gen</span><span class="p">)</span>
                <span class="n">gen</span><span class="o">.</span><span class="n">_Dynamic_last</span> <span class="o">=</span> <span class="n">value</span>
                <span class="n">gen</span><span class="o">.</span><span class="n">_Dynamic_time</span> <span class="o">=</span> <span class="n">time</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">value</span> <span class="o">=</span> <span class="n">gen</span><span class="o">.</span><span class="n">_Dynamic_last</span>

        <span class="k">return</span> <span class="n">value</span>


    <span class="k">def</span> <span class="nf">_value_is_dynamic</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">obj</span><span class="p">,</span><span class="n">objtype</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">"""</span>
<span class="sd">        Return True if the parameter is actually dynamic (i.e. the</span>
<span class="sd">        value is being generated).</span>
<span class="sd">        """</span>
        <span class="k">return</span> <span class="nb">hasattr</span><span class="p">(</span><span class="nb">super</span><span class="p">(</span><span class="n">Dynamic</span><span class="p">,</span><span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__get__</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span><span class="n">objtype</span><span class="p">),</span><span class="s1">'_Dynamic_last'</span><span class="p">)</span>


    <span class="k">def</span> <span class="nf">_inspect</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">obj</span><span class="p">,</span><span class="n">objtype</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">"""Return the last generated value for this parameter."""</span>
        <span class="n">gen</span><span class="o">=</span><span class="nb">super</span><span class="p">(</span><span class="n">Dynamic</span><span class="p">,</span><span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__get__</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span><span class="n">objtype</span><span class="p">)</span>

        <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">gen</span><span class="p">,</span><span class="s1">'_Dynamic_last'</span><span class="p">):</span>
            <span class="k">return</span> <span class="n">gen</span><span class="o">.</span><span class="n">_Dynamic_last</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">gen</span>


    <span class="k">def</span> <span class="nf">_force</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">obj</span><span class="p">,</span><span class="n">objtype</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">"""Force a new value to be generated, and return it."""</span>
        <span class="n">gen</span><span class="o">=</span><span class="nb">super</span><span class="p">(</span><span class="n">Dynamic</span><span class="p">,</span><span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__get__</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span><span class="n">objtype</span><span class="p">)</span>

        <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">gen</span><span class="p">,</span><span class="s1">'_Dynamic_last'</span><span class="p">):</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_produce_value</span><span class="p">(</span><span class="n">gen</span><span class="p">,</span><span class="n">force</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">gen</span></div>


<span class="kn">import</span> <span class="nn">numbers</span>
<span class="k">def</span> <span class="nf">_is_number</span><span class="p">(</span><span class="n">obj</span><span class="p">):</span>
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span> <span class="n">numbers</span><span class="o">.</span><span class="n">Number</span><span class="p">):</span> <span class="k">return</span> <span class="kc">True</span>
    <span class="c1"># The extra check is for classes that behave like numbers, such as those</span>
    <span class="c1"># found in numpy, gmpy, etc.</span>
    <span class="k">elif</span> <span class="p">(</span><span class="nb">hasattr</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span> <span class="s1">'__int__'</span><span class="p">)</span> <span class="ow">and</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span> <span class="s1">'__add__'</span><span class="p">)):</span> <span class="k">return</span> <span class="kc">True</span>
    <span class="c1"># This is for older versions of gmpy</span>
    <span class="k">elif</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span> <span class="s1">'qdiv'</span><span class="p">):</span> <span class="k">return</span> <span class="kc">True</span>
    <span class="k">else</span><span class="p">:</span> <span class="k">return</span> <span class="kc">False</span>


<span class="k">def</span> <span class="nf">identity_hook</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span><span class="n">val</span><span class="p">):</span> <span class="k">return</span> <span class="n">val</span>



<div class="viewcode-block" id="Number"><a class="viewcode-back" href="../../Reference_Manual/param.html#param.__init__.Number">[docs]</a><span class="k">class</span> <span class="nc">Number</span><span class="p">(</span><span class="n">Dynamic</span><span class="p">):</span>
    <span class="sd">"""</span>
<span class="sd">    A numeric Dynamic Parameter, with a default value and optional bounds.</span>

<span class="sd">    There are two types of bounds: ``bounds`` and</span>
<span class="sd">    ``softbounds``.  ``bounds`` are hard bounds: the parameter must</span>
<span class="sd">    have a value within the specified range.  The default bounds are</span>
<span class="sd">    (None,None), meaning there are actually no hard bounds.  One or</span>
<span class="sd">    both bounds can be set by specifying a value</span>
<span class="sd">    (e.g. bounds=(None,10) means there is no lower bound, and an upper</span>
<span class="sd">    bound of 10). Bounds are inclusive by default, but exclusivity</span>
<span class="sd">    can be specified for each bound by setting inclusive_bounds</span>
<span class="sd">    (e.g. inclusive_bounds=(True,False) specifies an exclusive upper</span>
<span class="sd">    bound).</span>

<span class="sd">    Number is also a type of Dynamic parameter, so its value</span>
<span class="sd">    can be set to a callable to get a dynamically generated</span>
<span class="sd">    number (see Dynamic).</span>

<span class="sd">    When not being dynamically generated, bounds are checked when a</span>
<span class="sd">    Number is created or set. Using a default value outside the hard</span>
<span class="sd">    bounds, or one that is not numeric, results in an exception. When</span>
<span class="sd">    being dynamically generated, bounds are checked when the value</span>
<span class="sd">    of a Number is requested. A generated value that is not numeric,</span>
<span class="sd">    or is outside the hard bounds, results in an exception.</span>

<span class="sd">    As a special case, if allow_None=True (which is true by default if</span>
<span class="sd">    the parameter has a default of None when declared) then a value</span>
<span class="sd">    of None is also allowed.</span>

<span class="sd">    A separate function set_in_bounds() is provided that will</span>
<span class="sd">    silently crop the given value into the legal range, for use</span>
<span class="sd">    in, for instance, a GUI.</span>

<span class="sd">    ``softbounds`` are present to indicate the typical range of</span>
<span class="sd">    the parameter, but are not enforced. Setting the soft bounds</span>
<span class="sd">    allows, for instance, a GUI to know what values to display on</span>
<span class="sd">    sliders for the Number.</span>

<span class="sd">    Example of creating a Number::</span>

<span class="sd">      AB = Number(default=0.5, bounds=(None,10), softbounds=(0,1), doc='Distance from A to B.')</span>

<span class="sd">    """</span>

    <span class="vm">__slots__</span> <span class="o">=</span> <span class="p">[</span><span class="s1">'bounds'</span><span class="p">,</span><span class="s1">'_softbounds'</span><span class="p">,</span><span class="s1">'inclusive_bounds'</span><span class="p">,</span><span class="s1">'set_hook'</span><span class="p">]</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">default</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span><span class="n">bounds</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span><span class="n">softbounds</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span><span class="n">inclusive_bounds</span><span class="o">=</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span><span class="kc">True</span><span class="p">),</span><span class="o">**</span><span class="n">params</span><span class="p">):</span>
        <span class="sd">"""</span>
<span class="sd">        Initialize this parameter object and store the bounds.</span>

<span class="sd">        Non-dynamic default values are checked against the bounds.</span>
<span class="sd">        """</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">Number</span><span class="p">,</span><span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="n">default</span><span class="p">,</span><span class="o">**</span><span class="n">params</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">set_hook</span> <span class="o">=</span> <span class="n">identity_hook</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">bounds</span> <span class="o">=</span> <span class="n">bounds</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">inclusive_bounds</span> <span class="o">=</span> <span class="n">inclusive_bounds</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_softbounds</span> <span class="o">=</span> <span class="n">softbounds</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">callable</span><span class="p">(</span><span class="n">default</span><span class="p">):</span> <span class="bp">self</span><span class="o">.</span><span class="n">_check_value</span><span class="p">(</span><span class="n">default</span><span class="p">)</span>


    <span class="k">def</span> <span class="nf">__get__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">obj</span><span class="p">,</span><span class="n">objtype</span><span class="p">):</span>
        <span class="sd">"""</span>
<span class="sd">        Same as the superclass's __get__, but if the value was</span>
<span class="sd">        dynamically generated, check the bounds.</span>
<span class="sd">        """</span>
        <span class="n">result</span> <span class="o">=</span> <span class="nb">super</span><span class="p">(</span><span class="n">Number</span><span class="p">,</span><span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__get__</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span><span class="n">objtype</span><span class="p">)</span>
        <span class="c1"># CEBALERT: results in extra lookups (_value_is_dynamic() is</span>
        <span class="c1"># also looking up 'result' - should just pass it in). Note</span>
        <span class="c1"># that this method is called often.</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_value_is_dynamic</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span><span class="n">objtype</span><span class="p">):</span> <span class="bp">self</span><span class="o">.</span><span class="n">_check_value</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">result</span>


    <span class="k">def</span> <span class="nf">__set__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">obj</span><span class="p">,</span><span class="n">val</span><span class="p">):</span>
        <span class="sd">"""</span>
<span class="sd">        Set to the given value raising an exception if out of bounds.</span>
<span class="sd">        Also applies set_hook, providing support for conversions</span>
<span class="sd">        and transformations of the value.</span>
<span class="sd">        """</span>
        <span class="n">val</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">set_hook</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span><span class="n">val</span><span class="p">)</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="n">callable</span><span class="p">(</span><span class="n">val</span><span class="p">):</span> <span class="bp">self</span><span class="o">.</span><span class="n">_check_value</span><span class="p">(</span><span class="n">val</span><span class="p">)</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">Number</span><span class="p">,</span><span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__set__</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span><span class="n">val</span><span class="p">)</span>


    <span class="c1"># Allow softbounds to be used like a normal attribute, as it</span>
    <span class="c1"># probably should have been already (not _softbounds)</span>
    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">softbounds</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span> <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_softbounds</span>

    <span class="nd">@softbounds</span><span class="o">.</span><span class="n">setter</span>
    <span class="k">def</span> <span class="nf">softbounds</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">value</span><span class="p">):</span> <span class="bp">self</span><span class="o">.</span><span class="n">_softbounds</span> <span class="o">=</span> <span class="n">value</span>


<div class="viewcode-block" id="Number.set_in_bounds"><a class="viewcode-back" href="../../Reference_Manual/param.html#param.__init__.Number.set_in_bounds">[docs]</a>    <span class="k">def</span> <span class="nf">set_in_bounds</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">obj</span><span class="p">,</span><span class="n">val</span><span class="p">):</span>
        <span class="sd">"""</span>
<span class="sd">        Set to the given value, but cropped to be within the legal bounds.</span>
<span class="sd">        All objects are accepted, and no exceptions will be raised.  See</span>
<span class="sd">        crop_to_bounds for details on how cropping is done.</span>
<span class="sd">        """</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">callable</span><span class="p">(</span><span class="n">val</span><span class="p">):</span>
            <span class="n">bounded_val</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">crop_to_bounds</span><span class="p">(</span><span class="n">val</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">bounded_val</span> <span class="o">=</span> <span class="n">val</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">Number</span><span class="p">,</span><span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__set__</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span><span class="n">bounded_val</span><span class="p">)</span></div>


    <span class="c1"># CEBERRORALERT: doesn't take account of exclusive bounds; see</span>
    <span class="c1"># https://github.com/ioam/param/issues/80.</span>
<div class="viewcode-block" id="Number.crop_to_bounds"><a class="viewcode-back" href="../../Reference_Manual/param.html#param.__init__.Number.crop_to_bounds">[docs]</a>    <span class="k">def</span> <span class="nf">crop_to_bounds</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">val</span><span class="p">):</span>
        <span class="sd">"""</span>
<span class="sd">        Return the given value cropped to be within the hard bounds</span>
<span class="sd">        for this parameter.</span>

<span class="sd">        If a numeric value is passed in, check it is within the hard</span>
<span class="sd">        bounds. If it is larger than the high bound, return the high</span>
<span class="sd">        bound. If it's smaller, return the low bound. In either case, the</span>
<span class="sd">        returned value could be None.  If a non-numeric value is passed</span>
<span class="sd">        in, set to be the default value (which could be None).  In no</span>
<span class="sd">        case is an exception raised; all values are accepted.</span>
<span class="sd">        """</span>
        <span class="c1"># Currently, values outside the bounds are silently cropped to</span>
        <span class="c1"># be inside the bounds; it may be appropriate to add a warning</span>
        <span class="c1"># in such cases.</span>
        <span class="k">if</span> <span class="n">_is_number</span><span class="p">(</span><span class="n">val</span><span class="p">):</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">bounds</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="k">return</span> <span class="n">val</span>
            <span class="n">vmin</span><span class="p">,</span> <span class="n">vmax</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">bounds</span>
            <span class="k">if</span> <span class="n">vmin</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">val</span> <span class="o">&lt;</span> <span class="n">vmin</span><span class="p">:</span>
                    <span class="k">return</span>  <span class="n">vmin</span>

            <span class="k">if</span> <span class="n">vmax</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">val</span> <span class="o">&gt;</span> <span class="n">vmax</span><span class="p">:</span>
                    <span class="k">return</span> <span class="n">vmax</span>

        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">allow_None</span> <span class="ow">and</span> <span class="n">val</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">val</span>

        <span class="k">else</span><span class="p">:</span>
            <span class="c1"># non-numeric value sent in: reverts to default value</span>
            <span class="k">return</span>  <span class="bp">self</span><span class="o">.</span><span class="n">default</span>

        <span class="k">return</span> <span class="n">val</span></div>


    <span class="k">def</span> <span class="nf">_checkBounds</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">val</span><span class="p">):</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">bounds</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">vmin</span><span class="p">,</span><span class="n">vmax</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">bounds</span>
            <span class="n">incmin</span><span class="p">,</span><span class="n">incmax</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">inclusive_bounds</span>

            <span class="c1"># Could simplify: see https://github.com/ioam/param/issues/83</span>
            <span class="k">if</span> <span class="n">vmax</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">incmax</span> <span class="ow">is</span> <span class="kc">True</span><span class="p">:</span>
                    <span class="k">if</span> <span class="ow">not</span> <span class="n">val</span> <span class="o">&lt;=</span> <span class="n">vmax</span><span class="p">:</span>
                        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">"Parameter '</span><span class="si">%s</span><span class="s2">' must be at most </span><span class="si">%s</span><span class="s2">"</span><span class="o">%</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_attrib_name</span><span class="p">,</span><span class="n">vmax</span><span class="p">))</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="k">if</span> <span class="ow">not</span> <span class="n">val</span> <span class="o">&lt;</span> <span class="n">vmax</span><span class="p">:</span>
                        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">"Parameter '</span><span class="si">%s</span><span class="s2">' must be less than </span><span class="si">%s</span><span class="s2">"</span><span class="o">%</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_attrib_name</span><span class="p">,</span><span class="n">vmax</span><span class="p">))</span>

            <span class="k">if</span> <span class="n">vmin</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">incmin</span> <span class="ow">is</span> <span class="kc">True</span><span class="p">:</span>
                    <span class="k">if</span> <span class="ow">not</span> <span class="n">val</span> <span class="o">&gt;=</span> <span class="n">vmin</span><span class="p">:</span>
                        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">"Parameter '</span><span class="si">%s</span><span class="s2">' must be at least </span><span class="si">%s</span><span class="s2">"</span><span class="o">%</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_attrib_name</span><span class="p">,</span><span class="n">vmin</span><span class="p">))</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="k">if</span> <span class="ow">not</span> <span class="n">val</span> <span class="o">&gt;</span> <span class="n">vmin</span><span class="p">:</span>
                        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">"Parameter '</span><span class="si">%s</span><span class="s2">' must be greater than </span><span class="si">%s</span><span class="s2">"</span><span class="o">%</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_attrib_name</span><span class="p">,</span><span class="n">vmin</span><span class="p">))</span>



    <span class="k">def</span> <span class="nf">_check_value</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">val</span><span class="p">):</span>
        <span class="sd">"""</span>
<span class="sd">        Checks that the value is numeric and that it is within the hard</span>
<span class="sd">        bounds; if not, an exception is raised.</span>
<span class="sd">        """</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">allow_None</span> <span class="ow">and</span> <span class="n">val</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="n">_is_number</span><span class="p">(</span><span class="n">val</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">"Parameter '</span><span class="si">%s</span><span class="s2">' only takes numeric values"</span><span class="o">%</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_attrib_name</span><span class="p">))</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_checkBounds</span><span class="p">(</span><span class="n">val</span><span class="p">)</span>


<div class="viewcode-block" id="Number.get_soft_bounds"><a class="viewcode-back" href="../../Reference_Manual/param.html#param.__init__.Number.get_soft_bounds">[docs]</a>    <span class="k">def</span> <span class="nf">get_soft_bounds</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">"""</span>
<span class="sd">        For each soft bound (upper and lower), if there is a defined bound (not equal to None)</span>
<span class="sd">        then it is returned, otherwise it defaults to the hard bound. The hard bound could still be None.</span>
<span class="sd">        """</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">bounds</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">hl</span><span class="p">,</span><span class="n">hu</span><span class="o">=</span><span class="p">(</span><span class="kc">None</span><span class="p">,</span><span class="kc">None</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">hl</span><span class="p">,</span><span class="n">hu</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">bounds</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_softbounds</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">sl</span><span class="p">,</span><span class="n">su</span><span class="o">=</span><span class="p">(</span><span class="kc">None</span><span class="p">,</span><span class="kc">None</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">sl</span><span class="p">,</span><span class="n">su</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_softbounds</span>


        <span class="k">if</span> <span class="n">sl</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span> <span class="n">l</span> <span class="o">=</span> <span class="n">hl</span>
        <span class="k">else</span><span class="p">:</span>          <span class="n">l</span> <span class="o">=</span> <span class="n">sl</span>

        <span class="k">if</span> <span class="n">su</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span> <span class="n">u</span> <span class="o">=</span> <span class="n">hu</span>
        <span class="k">else</span><span class="p">:</span>          <span class="n">u</span> <span class="o">=</span> <span class="n">su</span>

        <span class="k">return</span> <span class="p">(</span><span class="n">l</span><span class="p">,</span><span class="n">u</span><span class="p">)</span></div></div>



<div class="viewcode-block" id="Integer"><a class="viewcode-back" href="../../Reference_Manual/param.html#param.__init__.Integer">[docs]</a><span class="k">class</span> <span class="nc">Integer</span><span class="p">(</span><span class="n">Number</span><span class="p">):</span>
    <span class="sd">"""Numeric Parameter required to be an Integer"""</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">default</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="o">**</span><span class="n">params</span><span class="p">):</span>
       <span class="n">Number</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">default</span><span class="o">=</span><span class="n">default</span><span class="p">,</span><span class="o">**</span><span class="n">params</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_check_value</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">val</span><span class="p">):</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">allow_None</span> <span class="ow">and</span> <span class="n">val</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">val</span><span class="p">,</span><span class="nb">int</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">"Parameter '</span><span class="si">%s</span><span class="s2">' must be an integer."</span><span class="o">%</span><span class="bp">self</span><span class="o">.</span><span class="n">_attrib_name</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_checkBounds</span><span class="p">(</span><span class="n">val</span><span class="p">)</span></div>



<div class="viewcode-block" id="Magnitude"><a class="viewcode-back" href="../../Reference_Manual/param.html#param.__init__.Magnitude">[docs]</a><span class="k">class</span> <span class="nc">Magnitude</span><span class="p">(</span><span class="n">Number</span><span class="p">):</span>
    <span class="sd">"""Numeric Parameter required to be in the range [0.0-1.0]."""</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">default</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span><span class="n">softbounds</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span><span class="o">**</span><span class="n">params</span><span class="p">):</span>
        <span class="n">Number</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">default</span><span class="o">=</span><span class="n">default</span><span class="p">,</span><span class="n">bounds</span><span class="o">=</span><span class="p">(</span><span class="mf">0.0</span><span class="p">,</span><span class="mf">1.0</span><span class="p">),</span><span class="n">softbounds</span><span class="o">=</span><span class="n">softbounds</span><span class="p">,</span><span class="o">**</span><span class="n">params</span><span class="p">)</span></div>



<div class="viewcode-block" id="Boolean"><a class="viewcode-back" href="../../Reference_Manual/param.html#param.__init__.Boolean">[docs]</a><span class="k">class</span> <span class="nc">Boolean</span><span class="p">(</span><span class="n">Parameter</span><span class="p">):</span>
    <span class="sd">"""Binary or tristate Boolean Parameter."""</span>

    <span class="vm">__slots__</span> <span class="o">=</span> <span class="p">[</span><span class="s1">'bounds'</span><span class="p">]</span>

    <span class="c1"># CB: bounds have no effect; see https://github.com/ioam/param/issues/82</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">default</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span><span class="n">bounds</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span><span class="o">**</span><span class="n">params</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">bounds</span> <span class="o">=</span> <span class="n">bounds</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">Boolean</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="n">default</span><span class="p">,</span><span class="o">**</span><span class="n">params</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">__set__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">obj</span><span class="p">,</span><span class="n">val</span><span class="p">):</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">allow_None</span><span class="p">:</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">val</span><span class="p">,</span><span class="nb">bool</span><span class="p">)</span> <span class="ow">and</span> <span class="n">val</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">"Boolean '</span><span class="si">%s</span><span class="s2">' only takes a Boolean value or None."</span>
                                 <span class="o">%</span><span class="bp">self</span><span class="o">.</span><span class="n">_attrib_name</span><span class="p">)</span>

            <span class="k">if</span> <span class="n">val</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">True</span> <span class="ow">and</span> <span class="n">val</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">False</span> <span class="ow">and</span> <span class="n">val</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">"Boolean '</span><span class="si">%s</span><span class="s2">' must be True, False, or None."</span><span class="o">%</span><span class="bp">self</span><span class="o">.</span><span class="n">_attrib_name</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">val</span><span class="p">,</span><span class="nb">bool</span><span class="p">):</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">"Boolean '</span><span class="si">%s</span><span class="s2">' only takes a Boolean value."</span><span class="o">%</span><span class="bp">self</span><span class="o">.</span><span class="n">_attrib_name</span><span class="p">)</span>

            <span class="k">if</span> <span class="n">val</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">True</span> <span class="ow">and</span> <span class="n">val</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">False</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">"Boolean '</span><span class="si">%s</span><span class="s2">' must be True or False."</span><span class="o">%</span><span class="bp">self</span><span class="o">.</span><span class="n">_attrib_name</span><span class="p">)</span>

        <span class="nb">super</span><span class="p">(</span><span class="n">Boolean</span><span class="p">,</span><span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__set__</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span><span class="n">val</span><span class="p">)</span></div>


<div class="viewcode-block" id="Tuple"><a class="viewcode-back" href="../../Reference_Manual/param.html#param.__init__.Tuple">[docs]</a><span class="k">class</span> <span class="nc">Tuple</span><span class="p">(</span><span class="n">Parameter</span><span class="p">):</span>
    <span class="sd">"""A tuple Parameter (e.g. ('a',7.6,[3,5])) with a fixed tuple length."""</span>

    <span class="vm">__slots__</span> <span class="o">=</span> <span class="p">[</span><span class="s1">'length'</span><span class="p">]</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">default</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">),</span><span class="n">length</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span><span class="o">**</span><span class="n">params</span><span class="p">):</span>
        <span class="sd">"""</span>
<span class="sd">        Initialize a tuple parameter with a fixed length (number of</span>
<span class="sd">        elements).  The length is determined by the initial default</span>
<span class="sd">        value, if any, and must be supplied explicitly otherwise.  The</span>
<span class="sd">        length is not allowed to change after instantiation.</span>
<span class="sd">        """</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">Tuple</span><span class="p">,</span><span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="n">default</span><span class="p">,</span><span class="o">**</span><span class="n">params</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">length</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">default</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">length</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">default</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">length</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">default</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">"</span><span class="si">%s</span><span class="s2">: length must be specified if no default is supplied."</span> <span class="o">%</span>
                             <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_attrib_name</span><span class="p">))</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">length</span> <span class="o">=</span> <span class="n">length</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_check</span><span class="p">(</span><span class="n">default</span><span class="p">)</span>



    <span class="k">def</span> <span class="nf">_check</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">val</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">val</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">allow_None</span><span class="p">:</span>
            <span class="k">return</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">val</span><span class="p">,</span><span class="nb">tuple</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">"Tuple '</span><span class="si">%s</span><span class="s2">' only takes a tuple value."</span><span class="o">%</span><span class="bp">self</span><span class="o">.</span><span class="n">_attrib_name</span><span class="p">)</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="nb">len</span><span class="p">(</span><span class="n">val</span><span class="p">)</span><span class="o">==</span><span class="bp">self</span><span class="o">.</span><span class="n">length</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">"</span><span class="si">%s</span><span class="s2">: tuple is not of the correct length (</span><span class="si">%d</span><span class="s2"> instead of </span><span class="si">%d</span><span class="s2">)."</span> <span class="o">%</span>
                             <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_attrib_name</span><span class="p">,</span><span class="nb">len</span><span class="p">(</span><span class="n">val</span><span class="p">),</span><span class="bp">self</span><span class="o">.</span><span class="n">length</span><span class="p">))</span>


    <span class="k">def</span> <span class="nf">__set__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">obj</span><span class="p">,</span><span class="n">val</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_check</span><span class="p">(</span><span class="n">val</span><span class="p">)</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">Tuple</span><span class="p">,</span><span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__set__</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span><span class="n">val</span><span class="p">)</span></div>



<div class="viewcode-block" id="NumericTuple"><a class="viewcode-back" href="../../Reference_Manual/param.html#param.__init__.NumericTuple">[docs]</a><span class="k">class</span> <span class="nc">NumericTuple</span><span class="p">(</span><span class="n">Tuple</span><span class="p">):</span>
    <span class="sd">"""A numeric tuple Parameter (e.g. (4.5,7.6,3)) with a fixed tuple length."""</span>

    <span class="k">def</span> <span class="nf">_check</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">val</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">NumericTuple</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">_check</span><span class="p">(</span><span class="n">val</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">allow_None</span> <span class="ow">and</span> <span class="n">val</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">):</span>
            <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="n">val</span><span class="p">:</span>
                <span class="k">if</span> <span class="ow">not</span> <span class="n">_is_number</span><span class="p">(</span><span class="n">n</span><span class="p">):</span>
                    <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">"</span><span class="si">%s</span><span class="s2">: tuple element is not numeric: </span><span class="si">%s</span><span class="s2">."</span> <span class="o">%</span>
                                     <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_attrib_name</span><span class="p">,</span><span class="nb">str</span><span class="p">(</span><span class="n">n</span><span class="p">)))</span></div>



<div class="viewcode-block" id="XYCoordinates"><a class="viewcode-back" href="../../Reference_Manual/param.html#param.__init__.XYCoordinates">[docs]</a><span class="k">class</span> <span class="nc">XYCoordinates</span><span class="p">(</span><span class="n">NumericTuple</span><span class="p">):</span>
    <span class="sd">"""A NumericTuple for an X,Y coordinate."""</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">default</span><span class="o">=</span><span class="p">(</span><span class="mf">0.0</span><span class="p">,</span><span class="mf">0.0</span><span class="p">),</span><span class="o">**</span><span class="n">params</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">XYCoordinates</span><span class="p">,</span><span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="n">default</span><span class="p">,</span><span class="n">length</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span><span class="o">**</span><span class="n">params</span><span class="p">)</span></div>



<div class="viewcode-block" id="Callable"><a class="viewcode-back" href="../../Reference_Manual/param.html#param.__init__.Callable">[docs]</a><span class="k">class</span> <span class="nc">Callable</span><span class="p">(</span><span class="n">Parameter</span><span class="p">):</span>
    <span class="sd">"""</span>
<span class="sd">    Parameter holding a value that is a callable object, such as a function.</span>

<span class="sd">    A keyword argument instantiate=True should be provided when a</span>
<span class="sd">    function object is used that might have state.  On the other hand,</span>
<span class="sd">    regular standalone functions cannot be deepcopied as of Python</span>
<span class="sd">    2.4, so instantiate must be False for those values.</span>
<span class="sd">    """</span>

    <span class="k">def</span> <span class="nf">__set__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">obj</span><span class="p">,</span><span class="n">val</span><span class="p">):</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">allow_None</span> <span class="ow">and</span> <span class="n">val</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span><span class="ow">not</span> <span class="n">callable</span><span class="p">(</span><span class="n">val</span><span class="p">)):</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">"Callable '</span><span class="si">%s</span><span class="s2">' only takes a callable object."</span><span class="o">%</span><span class="bp">self</span><span class="o">.</span><span class="n">_attrib_name</span><span class="p">)</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">Callable</span><span class="p">,</span><span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__set__</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span><span class="n">val</span><span class="p">)</span></div>



<div class="viewcode-block" id="Action"><a class="viewcode-back" href="../../Reference_Manual/param.html#param.__init__.Action">[docs]</a><span class="k">class</span> <span class="nc">Action</span><span class="p">(</span><span class="n">Callable</span><span class="p">):</span>
    <span class="sd">"""</span>
<span class="sd">    A user-provided function that can be invoked like a class or object method using ().</span>
<span class="sd">    In a GUI, this might be mapped to a button, but it can be invoked directly as well.</span>
<span class="sd">    """</span></div>
<span class="c1"># Currently same implementation as Callable, but kept separate to allow different handling in GUIs</span>


<span class="k">def</span> <span class="nf">_is_abstract</span><span class="p">(</span><span class="n">class_</span><span class="p">):</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">class_</span><span class="o">.</span><span class="n">abstract</span>
    <span class="k">except</span> <span class="ne">AttributeError</span><span class="p">:</span>
        <span class="k">return</span> <span class="kc">False</span>



<span class="c1"># CEBALERT: this should be a method of ClassSelector.</span>
<div class="viewcode-block" id="concrete_descendents"><a class="viewcode-back" href="../../Reference_Manual/param.html#param.__init__.concrete_descendents">[docs]</a><span class="k">def</span> <span class="nf">concrete_descendents</span><span class="p">(</span><span class="n">parentclass</span><span class="p">):</span>
    <span class="sd">"""</span>
<span class="sd">    Return a dictionary containing all subclasses of the specified</span>
<span class="sd">    parentclass, including the parentclass.  Only classes that are</span>
<span class="sd">    defined in scripts that have been run or modules that have been</span>
<span class="sd">    imported are included, so the caller will usually first do ``from</span>
<span class="sd">    package import *``.</span>

<span class="sd">    Only non-abstract classes will be included.</span>
<span class="sd">    """</span>
    <span class="k">return</span> <span class="nb">dict</span><span class="p">((</span><span class="n">c</span><span class="o">.</span><span class="vm">__name__</span><span class="p">,</span><span class="n">c</span><span class="p">)</span> <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">descendents</span><span class="p">(</span><span class="n">parentclass</span><span class="p">)</span>
                <span class="k">if</span> <span class="ow">not</span> <span class="n">_is_abstract</span><span class="p">(</span><span class="n">c</span><span class="p">))</span></div>



<div class="viewcode-block" id="Composite"><a class="viewcode-back" href="../../Reference_Manual/param.html#param.__init__.Composite">[docs]</a><span class="k">class</span> <span class="nc">Composite</span><span class="p">(</span><span class="n">Parameter</span><span class="p">):</span>
    <span class="sd">"""</span>
<span class="sd">    A Parameter that is a composite of a set of other attributes of the class.</span>

<span class="sd">    The constructor argument 'attribs' takes a list of attribute</span>
<span class="sd">    names, which may or may not be Parameters.  Getting the parameter</span>
<span class="sd">    returns a list of the values of the constituents of the composite,</span>
<span class="sd">    in the order specified.  Likewise, setting the parameter takes a</span>
<span class="sd">    sequence of values and sets the value of the constituent</span>
<span class="sd">    attributes.</span>
<span class="sd">    """</span>

    <span class="vm">__slots__</span><span class="o">=</span><span class="p">[</span><span class="s1">'attribs'</span><span class="p">,</span><span class="s1">'objtype'</span><span class="p">]</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">attribs</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span><span class="o">**</span><span class="n">kw</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">attribs</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">attribs</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">Composite</span><span class="p">,</span><span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span><span class="o">**</span><span class="n">kw</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">attribs</span> <span class="o">=</span> <span class="n">attribs</span>

    <span class="k">def</span> <span class="nf">__get__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">obj</span><span class="p">,</span><span class="n">objtype</span><span class="p">):</span>
        <span class="sd">"""</span>
<span class="sd">        Return the values of all the attribs, as a list.</span>
<span class="sd">        """</span>
        <span class="k">if</span> <span class="n">obj</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="p">[</span><span class="nb">getattr</span><span class="p">(</span><span class="n">objtype</span><span class="p">,</span><span class="n">a</span><span class="p">)</span> <span class="k">for</span> <span class="n">a</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">attribs</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="p">[</span><span class="nb">getattr</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span><span class="n">a</span><span class="p">)</span> <span class="k">for</span> <span class="n">a</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">attribs</span><span class="p">]</span>

    <span class="k">def</span> <span class="nf">__set__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">obj</span><span class="p">,</span><span class="n">val</span><span class="p">):</span>
        <span class="sd">"""</span>
<span class="sd">        Set the values of all the attribs.</span>
<span class="sd">        """</span>
        <span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">val</span><span class="p">)</span> <span class="o">==</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">attribs</span><span class="p">),</span><span class="s2">"Compound parameter '</span><span class="si">%s</span><span class="s2">' got the wrong number of values (needed </span><span class="si">%d</span><span class="s2">, but got </span><span class="si">%d</span><span class="s2">)."</span> <span class="o">%</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_attrib_name</span><span class="p">,</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">attribs</span><span class="p">),</span><span class="nb">len</span><span class="p">(</span><span class="n">val</span><span class="p">))</span>

        <span class="k">if</span> <span class="n">obj</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">a</span><span class="p">,</span><span class="n">v</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">attribs</span><span class="p">,</span><span class="n">val</span><span class="p">):</span>
                <span class="nb">setattr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">objtype</span><span class="p">,</span><span class="n">a</span><span class="p">,</span><span class="n">v</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">a</span><span class="p">,</span><span class="n">v</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">attribs</span><span class="p">,</span><span class="n">val</span><span class="p">):</span>
                <span class="nb">setattr</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span><span class="n">a</span><span class="p">,</span><span class="n">v</span><span class="p">)</span></div>


<div class="viewcode-block" id="Selector"><a class="viewcode-back" href="../../Reference_Manual/param.html#param.__init__.Selector">[docs]</a><span class="k">class</span> <span class="nc">Selector</span><span class="p">(</span><span class="n">Parameter</span><span class="p">):</span>
    <span class="sd">"""</span>
<span class="sd">    Parameter whose value must be chosen from a list of possibilities.</span>

<span class="sd">    Subclasses must implement get_range().</span>
<span class="sd">    """</span>

    <span class="n">__abstract</span> <span class="o">=</span> <span class="kc">True</span>

    <span class="k">def</span> <span class="nf">get_range</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">(</span><span class="s2">"get_range() must be implemented in subclasses."</span><span class="p">)</span></div>


<div class="viewcode-block" id="ObjectSelector"><a class="viewcode-back" href="../../Reference_Manual/param.html#param.__init__.ObjectSelector">[docs]</a><span class="k">class</span> <span class="nc">ObjectSelector</span><span class="p">(</span><span class="n">Selector</span><span class="p">):</span>
    <span class="sd">"""</span>
<span class="sd">    Parameter whose value must be one object from a list of possible objects.</span>

<span class="sd">    check_on_set restricts the value to be among the current list of</span>
<span class="sd">    objects. By default, if objects are initially supplied,</span>
<span class="sd">    check_on_set is True, whereas if no objects are initially</span>
<span class="sd">    supplied, check_on_set is False. This can be overridden by</span>
<span class="sd">    explicitly specifying check_on_set initially.</span>

<span class="sd">    If check_on_set is True (either because objects are supplied</span>
<span class="sd">    initially, or because it is explicitly specified), the default</span>
<span class="sd">    (initial) value must be among the list of objects (unless the</span>
<span class="sd">    default value is None).</span>
<span class="sd">    """</span>

    <span class="vm">__slots__</span> <span class="o">=</span> <span class="p">[</span><span class="s1">'objects'</span><span class="p">,</span><span class="s1">'compute_default_fn'</span><span class="p">,</span><span class="s1">'check_on_set'</span><span class="p">]</span>

    <span class="c1"># ObjectSelector is usually used to allow selection from a list of</span>
    <span class="c1"># existing objects, therefore instantiate is False by default.</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">default</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span><span class="n">objects</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span><span class="n">instantiate</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                 <span class="n">compute_default_fn</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span><span class="n">check_on_set</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span><span class="n">allow_None</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span><span class="o">**</span><span class="n">params</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">objects</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">objects</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">objects</span> <span class="o">=</span> <span class="n">objects</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">compute_default_fn</span> <span class="o">=</span> <span class="n">compute_default_fn</span>

        <span class="k">if</span> <span class="n">check_on_set</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">check_on_set</span><span class="o">=</span><span class="n">check_on_set</span>
        <span class="k">elif</span> <span class="nb">len</span><span class="p">(</span><span class="n">objects</span><span class="p">)</span><span class="o">==</span><span class="mi">0</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">check_on_set</span><span class="o">=</span><span class="kc">False</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">check_on_set</span><span class="o">=</span><span class="kc">True</span>

        <span class="nb">super</span><span class="p">(</span><span class="n">ObjectSelector</span><span class="p">,</span><span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="n">default</span><span class="p">,</span><span class="n">instantiate</span><span class="o">=</span><span class="n">instantiate</span><span class="p">,</span>
                                            <span class="o">**</span><span class="n">params</span><span class="p">)</span>
        <span class="c1"># Required as Parameter sets allow_None=True if default is None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">allow_None</span> <span class="o">=</span> <span class="n">allow_None</span>
        <span class="k">if</span> <span class="n">default</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">check_on_set</span> <span class="ow">is</span> <span class="kc">True</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_check_value</span><span class="p">(</span><span class="n">default</span><span class="p">)</span>


    <span class="c1"># CBNOTE: if the list of objects is changed, the current value for</span>
    <span class="c1"># this parameter in existing POs could be out of the new range.</span>

<div class="viewcode-block" id="ObjectSelector.compute_default"><a class="viewcode-back" href="../../Reference_Manual/param.html#param.__init__.ObjectSelector.compute_default">[docs]</a>    <span class="k">def</span> <span class="nf">compute_default</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">"""</span>
<span class="sd">        If this parameter's compute_default_fn is callable, call it</span>
<span class="sd">        and store the result in self.default.</span>

<span class="sd">        Also removes None from the list of objects (if the default is</span>
<span class="sd">        no longer None).</span>
<span class="sd">        """</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">default</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">callable</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">compute_default_fn</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">default</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">compute_default_fn</span><span class="p">()</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">default</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">objects</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">default</span><span class="p">)</span></div>


    <span class="k">def</span> <span class="nf">_check_value</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">val</span><span class="p">,</span><span class="n">obj</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">"""</span>
<span class="sd">        val must be None or one of the objects in self.objects.</span>
<span class="sd">        """</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="p">(</span><span class="n">val</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">objects</span> <span class="ow">or</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">allow_None</span> <span class="ow">and</span> <span class="n">val</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">)):</span>
            <span class="c1"># CEBALERT: can be called before __init__ has called</span>
            <span class="c1"># super's __init__, i.e. before attrib_name has been set.</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">attrib_name</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_attrib_name</span>
            <span class="k">except</span> <span class="ne">AttributeError</span><span class="p">:</span>
                <span class="n">attrib_name</span> <span class="o">=</span> <span class="s2">""</span>

            <span class="n">items</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="n">limiter</span> <span class="o">=</span> <span class="s1">']'</span>
            <span class="n">length</span> <span class="o">=</span> <span class="mi">0</span>
            <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">objects</span><span class="p">:</span>
                <span class="n">string</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">item</span><span class="p">)</span>
                <span class="n">length</span> <span class="o">+=</span> <span class="nb">len</span><span class="p">(</span><span class="n">string</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">length</span> <span class="o">&lt;</span> <span class="mi">200</span><span class="p">:</span>
                    <span class="n">items</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">string</span><span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">limiter</span> <span class="o">=</span> <span class="s1">', ...]'</span>
                    <span class="k">break</span>
            <span class="n">items</span> <span class="o">=</span> <span class="s1">'['</span> <span class="o">+</span> <span class="s1">', '</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">items</span><span class="p">)</span> <span class="o">+</span> <span class="n">limiter</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">"</span><span class="si">%s</span><span class="s2"> not in Parameter </span><span class="si">%s</span><span class="s2">'s list of possible objects, "</span>
                             <span class="s2">"valid options include </span><span class="si">%s</span><span class="s2">"</span><span class="o">%</span><span class="p">(</span><span class="n">val</span><span class="p">,</span><span class="n">attrib_name</span><span class="p">,</span> <span class="n">items</span><span class="p">))</span>

    <span class="k">def</span> <span class="nf">_ensure_value_is_in_objects</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">val</span><span class="p">):</span>
        <span class="sd">"""</span>
<span class="sd">        Make sure that the provided value is present on the objects list.</span>
<span class="sd">        Subclasses can override if they support multiple items on a list,</span>
<span class="sd">        to check each item instead.</span>
<span class="sd">        """</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="p">(</span><span class="n">val</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">objects</span><span class="p">):</span>
           <span class="bp">self</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">val</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">__set__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">obj</span><span class="p">,</span><span class="n">val</span><span class="p">):</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">check_on_set</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_check_value</span><span class="p">(</span><span class="n">val</span><span class="p">,</span><span class="n">obj</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_ensure_value_is_in_objects</span><span class="p">(</span><span class="n">val</span><span class="p">)</span>

        <span class="nb">super</span><span class="p">(</span><span class="n">ObjectSelector</span><span class="p">,</span><span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__set__</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span><span class="n">val</span><span class="p">)</span>


<div class="viewcode-block" id="ObjectSelector.get_range"><a class="viewcode-back" href="../../Reference_Manual/param.html#param.__init__.ObjectSelector.get_range">[docs]</a>    <span class="k">def</span> <span class="nf">get_range</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">"""</span>
<span class="sd">        Return the possible objects to which this parameter could be set.</span>

<span class="sd">        (Returns the dictionary {object.name:object}.)</span>
<span class="sd">        """</span>
        <span class="k">return</span> <span class="n">named_objs</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">objects</span><span class="p">)</span></div></div>


<div class="viewcode-block" id="ClassSelector"><a class="viewcode-back" href="../../Reference_Manual/param.html#param.__init__.ClassSelector">[docs]</a><span class="k">class</span> <span class="nc">ClassSelector</span><span class="p">(</span><span class="n">Selector</span><span class="p">):</span>
    <span class="sd">"""</span>
<span class="sd">    Parameter whose value is a specified class or an instance of that class.</span>
<span class="sd">    By default, requires an instance, but if is_instance=False, accepts a class instead.</span>
<span class="sd">    Both class and instance values respect the instantiate slot, though it matters only</span>
<span class="sd">    for is_instance=True.</span>
<span class="sd">    """</span>

    <span class="vm">__slots__</span> <span class="o">=</span> <span class="p">[</span><span class="s1">'class_'</span><span class="p">,</span><span class="s1">'is_instance'</span><span class="p">]</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">class_</span><span class="p">,</span><span class="n">default</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span><span class="n">instantiate</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span><span class="n">is_instance</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span><span class="o">**</span><span class="n">params</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">class_</span> <span class="o">=</span> <span class="n">class_</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">is_instance</span> <span class="o">=</span> <span class="n">is_instance</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">ClassSelector</span><span class="p">,</span><span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="n">default</span><span class="p">,</span><span class="n">instantiate</span><span class="o">=</span><span class="n">instantiate</span><span class="p">,</span><span class="o">**</span><span class="n">params</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_check_value</span><span class="p">(</span><span class="n">default</span><span class="p">)</span>


    <span class="k">def</span> <span class="nf">_check_value</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">val</span><span class="p">,</span><span class="n">obj</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">"""val must be None, an instance of self.class_ if self.is_instance=True or a subclass of self_class if self.is_instance=False"""</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">class_</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">):</span>
            <span class="n">class_name</span> <span class="o">=</span> <span class="p">(</span><span class="s1">'(</span><span class="si">%s</span><span class="s1">)'</span> <span class="o">%</span> <span class="s1">', '</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">cl</span><span class="o">.</span><span class="vm">__name__</span> <span class="k">for</span> <span class="n">cl</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">class_</span><span class="p">))</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">class_name</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">class_</span><span class="o">.</span><span class="vm">__name__</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_instance</span><span class="p">:</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="p">(</span><span class="nb">isinstance</span><span class="p">(</span><span class="n">val</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">class_</span><span class="p">))</span> <span class="ow">and</span> <span class="ow">not</span> <span class="p">(</span><span class="n">val</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">allow_None</span><span class="p">):</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                    <span class="s2">"Parameter '</span><span class="si">%s</span><span class="s2">' value must be an instance of </span><span class="si">%s</span><span class="s2">, not '</span><span class="si">%s</span><span class="s2">'"</span> <span class="o">%</span>
                    <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_attrib_name</span><span class="p">,</span> <span class="n">class_name</span><span class="p">,</span> <span class="n">val</span><span class="p">))</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="p">(</span><span class="n">val</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">allow_None</span><span class="p">)</span> <span class="ow">and</span> <span class="ow">not</span> <span class="p">(</span><span class="nb">issubclass</span><span class="p">(</span><span class="n">val</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">class_</span><span class="p">)):</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                    <span class="s2">"Parameter '</span><span class="si">%s</span><span class="s2">' must be a subclass of </span><span class="si">%s</span><span class="s2">, not '</span><span class="si">%s</span><span class="s2">'"</span> <span class="o">%</span>
                    <span class="p">(</span><span class="n">val</span><span class="o">.</span><span class="vm">__name__</span><span class="p">,</span> <span class="n">class_name</span><span class="p">,</span> <span class="n">val</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span><span class="p">))</span>


    <span class="k">def</span> <span class="nf">__set__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">obj</span><span class="p">,</span><span class="n">val</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_check_value</span><span class="p">(</span><span class="n">val</span><span class="p">,</span><span class="n">obj</span><span class="p">)</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">ClassSelector</span><span class="p">,</span><span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__set__</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span><span class="n">val</span><span class="p">)</span>


<div class="viewcode-block" id="ClassSelector.get_range"><a class="viewcode-back" href="../../Reference_Manual/param.html#param.__init__.ClassSelector.get_range">[docs]</a>    <span class="k">def</span> <span class="nf">get_range</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">"""</span>
<span class="sd">        Return the possible types for this parameter's value.</span>

<span class="sd">        (I.e. return {name: &lt;class&gt;} for all classes that are</span>
<span class="sd">        concrete_descendents() of self.class_.)</span>

<span class="sd">        Only classes from modules that have been imported are added</span>
<span class="sd">        (see concrete_descendents()).</span>
<span class="sd">        """</span>
        <span class="n">classes</span> <span class="o">=</span> <span class="n">concrete_descendents</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">class_</span><span class="p">)</span>
        <span class="n">d</span><span class="o">=</span><span class="n">OrderedDict</span><span class="p">((</span><span class="n">name</span><span class="p">,</span><span class="n">class_</span><span class="p">)</span> <span class="k">for</span> <span class="n">name</span><span class="p">,</span><span class="n">class_</span> <span class="ow">in</span> <span class="n">classes</span><span class="o">.</span><span class="n">items</span><span class="p">())</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">allow_None</span><span class="p">:</span>
            <span class="n">d</span><span class="p">[</span><span class="s1">'None'</span><span class="p">]</span><span class="o">=</span><span class="kc">None</span>
        <span class="k">return</span> <span class="n">d</span></div></div>


<div class="viewcode-block" id="List"><a class="viewcode-back" href="../../Reference_Manual/param.html#param.__init__.List">[docs]</a><span class="k">class</span> <span class="nc">List</span><span class="p">(</span><span class="n">Parameter</span><span class="p">):</span>
    <span class="sd">"""</span>
<span class="sd">    Parameter whose value is a list of objects, usually of a specified type.</span>

<span class="sd">    The bounds allow a minimum and/or maximum length of</span>
<span class="sd">    list to be enforced.  If the class is non-None, all</span>
<span class="sd">    items in the list are checked to be of that type.</span>
<span class="sd">    """</span>

    <span class="vm">__slots__</span> <span class="o">=</span> <span class="p">[</span><span class="s1">'class_'</span><span class="p">,</span><span class="s1">'bounds'</span><span class="p">]</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">default</span><span class="o">=</span><span class="p">[],</span><span class="n">class_</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span><span class="n">instantiate</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                 <span class="n">bounds</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="kc">None</span><span class="p">),</span><span class="o">**</span><span class="n">params</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">class_</span> <span class="o">=</span> <span class="n">class_</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">bounds</span> <span class="o">=</span> <span class="n">bounds</span>
        <span class="n">Parameter</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">default</span><span class="o">=</span><span class="n">default</span><span class="p">,</span><span class="n">instantiate</span><span class="o">=</span><span class="n">instantiate</span><span class="p">,</span>
                           <span class="o">**</span><span class="n">params</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_check_bounds</span><span class="p">(</span><span class="n">default</span><span class="p">)</span>

    <span class="c1"># Could add range() method from ClassSelector, to allow</span>
    <span class="c1"># list to be populated in the GUI</span>

    <span class="k">def</span> <span class="nf">__set__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">obj</span><span class="p">,</span><span class="n">val</span><span class="p">):</span>
        <span class="sd">"""Set to the given value, raising an exception if out of bounds."""</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_check_bounds</span><span class="p">(</span><span class="n">val</span><span class="p">)</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">List</span><span class="p">,</span><span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__set__</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span><span class="n">val</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_check_bounds</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">val</span><span class="p">):</span>
        <span class="sd">"""</span>
<span class="sd">        Checks that the list is of the right length and has the right contents.</span>
<span class="sd">        Otherwise, an exception is raised.</span>
<span class="sd">        """</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">allow_None</span> <span class="ow">and</span> <span class="n">val</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">val</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">"List '</span><span class="si">%s</span><span class="s2">' must be a list."</span><span class="o">%</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_attrib_name</span><span class="p">))</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">bounds</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">min_length</span><span class="p">,</span><span class="n">max_length</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">bounds</span>
            <span class="n">l</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">val</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">min_length</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">max_length</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="k">if</span> <span class="ow">not</span> <span class="p">(</span><span class="n">min_length</span> <span class="o">&lt;=</span> <span class="n">l</span> <span class="o">&lt;=</span> <span class="n">max_length</span><span class="p">):</span>
                    <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">"</span><span class="si">%s</span><span class="s2">: list length must be between </span><span class="si">%s</span><span class="s2"> and </span><span class="si">%s</span><span class="s2"> (inclusive)"</span><span class="o">%</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_attrib_name</span><span class="p">,</span><span class="n">min_length</span><span class="p">,</span><span class="n">max_length</span><span class="p">))</span>
            <span class="k">elif</span> <span class="n">min_length</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="k">if</span> <span class="ow">not</span> <span class="n">min_length</span> <span class="o">&lt;=</span> <span class="n">l</span><span class="p">:</span>
                    <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">"</span><span class="si">%s</span><span class="s2">: list length must be at least </span><span class="si">%s</span><span class="s2">."</span><span class="o">%</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_attrib_name</span><span class="p">,</span><span class="n">min_length</span><span class="p">))</span>
            <span class="k">elif</span> <span class="n">max_length</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="k">if</span> <span class="ow">not</span> <span class="n">l</span> <span class="o">&lt;=</span> <span class="n">max_length</span><span class="p">:</span>
                    <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">"</span><span class="si">%s</span><span class="s2">: list length must be at most </span><span class="si">%s</span><span class="s2">."</span><span class="o">%</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_attrib_name</span><span class="p">,</span><span class="n">max_length</span><span class="p">))</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_check_type</span><span class="p">(</span><span class="n">val</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_check_type</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">val</span><span class="p">):</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">class_</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">val</span><span class="p">:</span>
                <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">v</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">class_</span><span class="p">),</span><span class="nb">repr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_attrib_name</span><span class="p">)</span><span class="o">+</span><span class="s2">": "</span><span class="o">+</span><span class="nb">repr</span><span class="p">(</span><span class="n">v</span><span class="p">)</span><span class="o">+</span><span class="s2">" is not an instance of "</span> <span class="o">+</span> <span class="nb">repr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">class_</span><span class="p">)</span> <span class="o">+</span> <span class="s2">"."</span></div>



<div class="viewcode-block" id="HookList"><a class="viewcode-back" href="../../Reference_Manual/param.html#param.__init__.HookList">[docs]</a><span class="k">class</span> <span class="nc">HookList</span><span class="p">(</span><span class="n">List</span><span class="p">):</span>
    <span class="sd">"""</span>
<span class="sd">    Parameter whose value is a list of callable objects.</span>

<span class="sd">    This type of List Parameter is typically used to provide a place</span>
<span class="sd">    for users to register a set of commands to be called at a</span>
<span class="sd">    specified place in some sequence of processing steps.</span>
<span class="sd">    """</span>
    <span class="vm">__slots__</span> <span class="o">=</span> <span class="p">[</span><span class="s1">'class_'</span><span class="p">,</span><span class="s1">'bounds'</span><span class="p">]</span>

    <span class="k">def</span> <span class="nf">_check_type</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">val</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">val</span><span class="p">:</span>
            <span class="k">assert</span> <span class="n">callable</span><span class="p">(</span><span class="n">v</span><span class="p">),</span><span class="nb">repr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_attrib_name</span><span class="p">)</span><span class="o">+</span><span class="s2">": "</span><span class="o">+</span><span class="nb">repr</span><span class="p">(</span><span class="n">v</span><span class="p">)</span><span class="o">+</span><span class="s2">" is not callable."</span></div>



<div class="viewcode-block" id="Dict"><a class="viewcode-back" href="../../Reference_Manual/param.html#param.__init__.Dict">[docs]</a><span class="k">class</span> <span class="nc">Dict</span><span class="p">(</span><span class="n">ClassSelector</span><span class="p">):</span>
    <span class="sd">"""</span>
<span class="sd">    Parameter whose value is a dictionary.</span>
<span class="sd">    """</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="o">**</span><span class="n">params</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">Dict</span><span class="p">,</span><span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="nb">dict</span><span class="p">,</span><span class="o">**</span><span class="n">params</span><span class="p">)</span></div>


<div class="viewcode-block" id="Array"><a class="viewcode-back" href="../../Reference_Manual/param.html#param.__init__.Array">[docs]</a><span class="k">class</span> <span class="nc">Array</span><span class="p">(</span><span class="n">ClassSelector</span><span class="p">):</span>
    <span class="sd">"""</span>
<span class="sd">    Parameter whose value is a numpy array.</span>
<span class="sd">    """</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">params</span><span class="p">):</span>
        <span class="c1"># CEBALERT: instead use python array as default?</span>
        <span class="kn">from</span> <span class="nn">numpy</span> <span class="k">import</span> <span class="n">ndarray</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">Array</span><span class="p">,</span><span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">ndarray</span><span class="p">,</span> <span class="n">allow_None</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="o">**</span><span class="n">params</span><span class="p">)</span></div>


<span class="c1"># For portable code:</span>
<span class="c1">#   - specify paths in unix (rather than Windows) style;</span>
<span class="c1">#   - use resolve_file_path() for paths to existing files to be read,</span>
<span class="c1">#   - use resolve_folder_path() for paths to existing folders to be read,</span>
<span class="c1">#     and normalize_path() for paths to new files to be written.</span>

<div class="viewcode-block" id="resolve_path"><a class="viewcode-back" href="../../Reference_Manual/param.html#param.__init__.resolve_path">[docs]</a><span class="k">class</span> <span class="nc">resolve_path</span><span class="p">(</span><span class="n">ParameterizedFunction</span><span class="p">):</span>
    <span class="sd">"""</span>
<span class="sd">    Find the path to an existing file, searching the paths specified</span>
<span class="sd">    in the search_paths parameter if the filename is not absolute, and</span>
<span class="sd">    converting a UNIX-style path to the current OS's format if</span>
<span class="sd">    necessary.</span>

<span class="sd">    To turn a supplied relative path into an absolute one, the path is</span>
<span class="sd">    appended to paths in the search_paths parameter, in order, until</span>
<span class="sd">    the file is found.</span>

<span class="sd">    An IOError is raised if the file is not found.</span>

<span class="sd">    Similar to Python's os.path.abspath(), except more search paths</span>
<span class="sd">    than just os.getcwd() can be used, and the file must exist.</span>
<span class="sd">    """</span>

    <span class="n">search_paths</span> <span class="o">=</span> <span class="n">List</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="p">[</span><span class="n">os</span><span class="o">.</span><span class="n">getcwd</span><span class="p">()],</span> <span class="n">pickle_default_value</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">doc</span><span class="o">=</span><span class="s2">"""</span>
<span class="s2">        Prepended to a non-relative path, in order, until a file is</span>
<span class="s2">        found."""</span><span class="p">)</span>

    <span class="n">path_to_file</span> <span class="o">=</span> <span class="n">Boolean</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">pickle_default_value</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">doc</span><span class="o">=</span><span class="s2">"""</span>
<span class="s2">        String specifying whether the path refers to a 'File' or a 'Folder'."""</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">__call__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">path</span><span class="p">,</span> <span class="o">**</span><span class="n">params</span><span class="p">):</span>
        <span class="n">p</span> <span class="o">=</span> <span class="n">ParamOverrides</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">params</span><span class="p">)</span>

        <span class="n">path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">normpath</span><span class="p">(</span><span class="n">path</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isabs</span><span class="p">(</span><span class="n">path</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">p</span><span class="o">.</span><span class="n">path_to_file</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isfile</span><span class="p">(</span><span class="n">path</span><span class="p">):</span>
                    <span class="k">return</span> <span class="n">path</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="k">raise</span> <span class="ne">IOError</span><span class="p">(</span><span class="s2">"File '</span><span class="si">%s</span><span class="s2">' not found."</span> <span class="o">%</span><span class="n">path</span><span class="p">)</span>
            <span class="k">elif</span> <span class="ow">not</span> <span class="n">p</span><span class="o">.</span><span class="n">path_to_file</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isdir</span><span class="p">(</span><span class="n">path</span><span class="p">):</span>
                    <span class="k">return</span> <span class="n">path</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="k">raise</span> <span class="ne">IOError</span><span class="p">(</span><span class="s2">"Folder '</span><span class="si">%s</span><span class="s2">' not found."</span> <span class="o">%</span><span class="n">path</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">IOError</span><span class="p">(</span><span class="s2">"Type '</span><span class="si">%s</span><span class="s2">' not recognised."</span> <span class="o">%</span><span class="n">p</span><span class="o">.</span><span class="n">path_type</span><span class="p">)</span>

        <span class="k">else</span><span class="p">:</span>
            <span class="n">paths_tried</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="k">for</span> <span class="n">prefix</span> <span class="ow">in</span> <span class="n">p</span><span class="o">.</span><span class="n">search_paths</span><span class="p">:</span>
                <span class="n">try_path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">normpath</span><span class="p">(</span><span class="n">prefix</span><span class="p">),</span> <span class="n">path</span><span class="p">)</span>

                <span class="k">if</span> <span class="n">p</span><span class="o">.</span><span class="n">path_to_file</span><span class="p">:</span>
                    <span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isfile</span><span class="p">(</span><span class="n">try_path</span><span class="p">):</span>
                        <span class="k">return</span> <span class="n">try_path</span>
                <span class="k">elif</span> <span class="ow">not</span> <span class="n">p</span><span class="o">.</span><span class="n">path_to_file</span><span class="p">:</span>
                    <span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isdir</span><span class="p">(</span><span class="n">try_path</span><span class="p">):</span>
                        <span class="k">return</span> <span class="n">try_path</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="k">raise</span> <span class="ne">IOError</span><span class="p">(</span><span class="s2">"Type '</span><span class="si">%s</span><span class="s2">' not recognised."</span> <span class="o">%</span><span class="n">p</span><span class="o">.</span><span class="n">path_type</span><span class="p">)</span>

                <span class="n">paths_tried</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">try_path</span><span class="p">)</span>

            <span class="k">raise</span> <span class="ne">IOError</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="n">path</span><span class="p">)[</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="s2">" was not found in the following place(s): "</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">paths_tried</span><span class="p">)</span> <span class="o">+</span> <span class="s2">"."</span><span class="p">)</span></div>


<div class="viewcode-block" id="normalize_path"><a class="viewcode-back" href="../../Reference_Manual/param.html#param.__init__.normalize_path">[docs]</a><span class="k">class</span> <span class="nc">normalize_path</span><span class="p">(</span><span class="n">ParameterizedFunction</span><span class="p">):</span>
    <span class="sd">"""</span>
<span class="sd">    Convert a UNIX-style path to the current OS's format,</span>
<span class="sd">    typically for creating a new file or directory.</span>

<span class="sd">    If the path is not already absolute, it will be made absolute</span>
<span class="sd">    (using the prefix parameter).</span>

<span class="sd">    Should do the same as Python's os.path.abspath(), except using</span>
<span class="sd">    prefix rather than os.getcwd).</span>
<span class="sd">    """</span>

    <span class="n">prefix</span> <span class="o">=</span> <span class="n">String</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="n">os</span><span class="o">.</span><span class="n">getcwd</span><span class="p">(),</span><span class="n">pickle_default_value</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span><span class="n">doc</span><span class="o">=</span><span class="s2">"""</span>
<span class="s2">        Prepended to the specified path, if that path is not</span>
<span class="s2">        absolute."""</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">__call__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">path</span><span class="o">=</span><span class="s2">""</span><span class="p">,</span><span class="o">**</span><span class="n">params</span><span class="p">):</span>
        <span class="n">p</span> <span class="o">=</span> <span class="n">ParamOverrides</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">params</span><span class="p">)</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isabs</span><span class="p">(</span><span class="n">path</span><span class="p">):</span>
            <span class="n">path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">normpath</span><span class="p">(</span><span class="n">p</span><span class="o">.</span><span class="n">prefix</span><span class="p">),</span><span class="n">path</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">normpath</span><span class="p">(</span><span class="n">path</span><span class="p">)</span></div>



<div class="viewcode-block" id="Path"><a class="viewcode-back" href="../../Reference_Manual/param.html#param.__init__.Path">[docs]</a><span class="k">class</span> <span class="nc">Path</span><span class="p">(</span><span class="n">Parameter</span><span class="p">):</span>
    <span class="sd">"""</span>
<span class="sd">    Parameter that can be set to a string specifying the path of a file or folder.</span>

<span class="sd">    The string should be specified in UNIX style, but it will be</span>
<span class="sd">    returned in the format of the user's operating system. Please use</span>
<span class="sd">    the Filename or Foldername classes if you require discrimination</span>
<span class="sd">    between the two possibilities.</span>

<span class="sd">    The specified path can be absolute, or relative to either:</span>

<span class="sd">    * any of the paths specified in the search_paths attribute (if</span>
<span class="sd">      search_paths is not None);</span>

<span class="sd">    or</span>

<span class="sd">    * any of the paths searched by resolve_path() (if search_paths</span>
<span class="sd">      is None).</span>
<span class="sd">    """</span>

    <span class="vm">__slots__</span> <span class="o">=</span> <span class="p">[</span><span class="s1">'search_paths'</span><span class="p">]</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">search_paths</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">params</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">search_paths</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">search_paths</span> <span class="o">=</span> <span class="p">[]</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">search_paths</span> <span class="o">=</span> <span class="n">search_paths</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">Path</span><span class="p">,</span><span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">default</span><span class="p">,</span><span class="o">**</span><span class="n">params</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_resolve</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">path</span><span class="p">):</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">search_paths</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">resolve_path</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="n">search_paths</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">search_paths</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">resolve_path</span><span class="p">(</span><span class="n">path</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">__set__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">obj</span><span class="p">,</span> <span class="n">val</span><span class="p">):</span>
        <span class="sd">"""</span>
<span class="sd">        Call Parameter's __set__, but warn if the file cannot be found.</span>
<span class="sd">        """</span>
        <span class="k">if</span> <span class="n">val</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">allow_None</span><span class="p">:</span>
                <span class="n">Parameterized</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">"</span><span class="si">%s</span><span class="s2">.</span><span class="si">%s</span><span class="s2">"</span><span class="o">%</span><span class="p">(</span><span class="n">obj</span><span class="o">.</span><span class="n">name</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">_attrib_name</span><span class="p">))</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="s1">'None is not allowed'</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_resolve</span><span class="p">(</span><span class="n">val</span><span class="p">)</span>
            <span class="k">except</span> <span class="ne">IOError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
                <span class="n">Parameterized</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">"</span><span class="si">%s</span><span class="s2">.</span><span class="si">%s</span><span class="s2">"</span><span class="o">%</span><span class="p">(</span><span class="n">obj</span><span class="o">.</span><span class="n">name</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">_attrib_name</span><span class="p">))</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="s1">'</span><span class="si">%s</span><span class="s1">'</span><span class="p">,</span><span class="n">e</span><span class="o">.</span><span class="n">args</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">Path</span><span class="p">,</span><span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__set__</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span><span class="n">val</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">__get__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">obj</span><span class="p">,</span> <span class="n">objtype</span><span class="p">):</span>
        <span class="sd">"""</span>
<span class="sd">        Return an absolute, normalized path (see resolve_path).</span>
<span class="sd">        """</span>
        <span class="n">raw_path</span> <span class="o">=</span> <span class="nb">super</span><span class="p">(</span><span class="n">Path</span><span class="p">,</span><span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__get__</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span><span class="n">objtype</span><span class="p">)</span>
        <span class="k">return</span> <span class="kc">None</span> <span class="k">if</span> <span class="n">raw_path</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="bp">self</span><span class="o">.</span><span class="n">_resolve</span><span class="p">(</span><span class="n">raw_path</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">__getstate__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c1"># don't want to pickle the search_paths</span>
        <span class="n">state</span> <span class="o">=</span> <span class="nb">super</span><span class="p">(</span><span class="n">Path</span><span class="p">,</span><span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">__getstate__</span><span class="p">()</span>

        <span class="k">if</span> <span class="s1">'search_paths'</span> <span class="ow">in</span> <span class="n">state</span><span class="p">:</span>
            <span class="n">state</span><span class="p">[</span><span class="s1">'search_paths'</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>

        <span class="k">return</span> <span class="n">state</span></div>



<div class="viewcode-block" id="Filename"><a class="viewcode-back" href="../../Reference_Manual/param.html#param.__init__.Filename">[docs]</a><span class="k">class</span> <span class="nc">Filename</span><span class="p">(</span><span class="n">Path</span><span class="p">):</span>
    <span class="sd">"""</span>
<span class="sd">    Parameter that can be set to a string specifying the path of a file.</span>

<span class="sd">    The string should be specified in UNIX style, but it will be</span>
<span class="sd">    returned in the format of the user's operating system.</span>

<span class="sd">    The specified path can be absolute, or relative to either:</span>

<span class="sd">    * any of the paths specified in the search_paths attribute (if</span>
<span class="sd">      search_paths is not None);</span>
<span class="sd">    or</span>

<span class="sd">    * any of the paths searched by resolve_path() (if search_paths</span>
<span class="sd">      is None).</span>
<span class="sd">    """</span>

    <span class="k">def</span> <span class="nf">_resolve</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">path</span><span class="p">):</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">search_paths</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">resolve_path</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="n">path_to_file</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">search_paths</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">search_paths</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">resolve_path</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="n">path_to_file</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span></div>


<div class="viewcode-block" id="Foldername"><a class="viewcode-back" href="../../Reference_Manual/param.html#param.__init__.Foldername">[docs]</a><span class="k">class</span> <span class="nc">Foldername</span><span class="p">(</span><span class="n">Path</span><span class="p">):</span>
    <span class="sd">"""</span>
<span class="sd">    Parameter that can be set to a string specifying the path of a folder.</span>

<span class="sd">    The string should be specified in UNIX style, but it will be</span>
<span class="sd">    returned in the format of the user's operating system.</span>

<span class="sd">    The specified path can be absolute, or relative to either:</span>

<span class="sd">    * any of the paths specified in the search_paths attribute (if</span>
<span class="sd">      search_paths is not None);</span>
<span class="sd">    or</span>

<span class="sd">    * any of the paths searched by resolve_dir_path() (if search_paths</span>
<span class="sd">      is None).</span>
<span class="sd">    """</span>

    <span class="k">def</span> <span class="nf">_resolve</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">path</span><span class="p">):</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">search_paths</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">resolve_path</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="n">path_to_file</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">search_paths</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">search_paths</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">resolve_path</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="n">path_to_file</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></div>



<div class="viewcode-block" id="abbreviate_paths"><a class="viewcode-back" href="../../Reference_Manual/param.html#param.__init__.abbreviate_paths">[docs]</a><span class="k">def</span> <span class="nf">abbreviate_paths</span><span class="p">(</span><span class="n">pathspec</span><span class="p">,</span><span class="n">named_paths</span><span class="p">):</span>
    <span class="sd">"""</span>
<span class="sd">    Given a dict of (pathname,path) pairs, removes any prefix shared by all pathnames.</span>
<span class="sd">    Helps keep menu items short yet unambiguous.</span>
<span class="sd">    """</span>
    <span class="kn">from</span> <span class="nn">os.path</span> <span class="k">import</span> <span class="n">commonprefix</span><span class="p">,</span> <span class="n">dirname</span><span class="p">,</span> <span class="n">sep</span>

    <span class="n">prefix</span> <span class="o">=</span> <span class="n">commonprefix</span><span class="p">([</span><span class="n">dirname</span><span class="p">(</span><span class="n">name</span><span class="p">)</span><span class="o">+</span><span class="n">sep</span> <span class="k">for</span> <span class="n">name</span> <span class="ow">in</span> <span class="n">named_paths</span><span class="o">.</span><span class="n">keys</span><span class="p">()]</span><span class="o">+</span><span class="p">[</span><span class="n">pathspec</span><span class="p">])</span>
    <span class="k">return</span> <span class="n">OrderedDict</span><span class="p">([(</span><span class="n">name</span><span class="p">[</span><span class="nb">len</span><span class="p">(</span><span class="n">prefix</span><span class="p">):],</span><span class="n">path</span><span class="p">)</span> <span class="k">for</span> <span class="n">name</span><span class="p">,</span><span class="n">path</span> <span class="ow">in</span> <span class="n">named_paths</span><span class="o">.</span><span class="n">items</span><span class="p">()])</span></div>



<div class="viewcode-block" id="FileSelector"><a class="viewcode-back" href="../../Reference_Manual/param.html#param.__init__.FileSelector">[docs]</a><span class="k">class</span> <span class="nc">FileSelector</span><span class="p">(</span><span class="n">ObjectSelector</span><span class="p">):</span>
    <span class="sd">"""</span>
<span class="sd">    Given a path glob, allows one file to be selected from those matching.</span>
<span class="sd">    """</span>
    <span class="vm">__slots__</span> <span class="o">=</span> <span class="p">[</span><span class="s1">'path'</span><span class="p">]</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">path</span><span class="o">=</span><span class="s2">""</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">FileSelector</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">default</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">path</span> <span class="o">=</span> <span class="n">path</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">update</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">update</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">objects</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">glob</span><span class="o">.</span><span class="n">glob</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">path</span><span class="p">))</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">default</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">objects</span><span class="p">:</span>
            <span class="k">return</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">default</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">objects</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">objects</span> <span class="k">else</span> <span class="kc">None</span>

<div class="viewcode-block" id="FileSelector.get_range"><a class="viewcode-back" href="../../Reference_Manual/param.html#param.__init__.FileSelector.get_range">[docs]</a>    <span class="k">def</span> <span class="nf">get_range</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">abbreviate_paths</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">path</span><span class="p">,</span><span class="nb">super</span><span class="p">(</span><span class="n">FileSelector</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">get_range</span><span class="p">())</span></div></div>


<div class="viewcode-block" id="ListSelector"><a class="viewcode-back" href="../../Reference_Manual/param.html#param.__init__.ListSelector">[docs]</a><span class="k">class</span> <span class="nc">ListSelector</span><span class="p">(</span><span class="n">ObjectSelector</span><span class="p">):</span>
    <span class="sd">"""</span>
<span class="sd">    Variant of ObjectSelector where the value can be multiple objects from</span>
<span class="sd">    a list of possible objects.</span>
<span class="sd">    """</span>

<div class="viewcode-block" id="ListSelector.compute_default"><a class="viewcode-back" href="../../Reference_Manual/param.html#param.__init__.ListSelector.compute_default">[docs]</a>    <span class="k">def</span> <span class="nf">compute_default</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">default</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">callable</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">compute_default_fn</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">default</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">compute_default_fn</span><span class="p">()</span>
            <span class="k">for</span> <span class="n">o</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">default</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">o</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">objects</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">o</span><span class="p">)</span></div>

    <span class="k">def</span> <span class="nf">_check_value</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">val</span><span class="p">,</span> <span class="n">obj</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">o</span> <span class="ow">in</span> <span class="n">val</span><span class="p">:</span>
            <span class="nb">super</span><span class="p">(</span><span class="n">ListSelector</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">_check_value</span><span class="p">(</span><span class="n">o</span><span class="p">,</span> <span class="n">obj</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_ensure_value_is_in_objects</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">val</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">o</span> <span class="ow">in</span> <span class="n">val</span><span class="p">:</span>
            <span class="nb">super</span><span class="p">(</span><span class="n">ListSelector</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">_ensure_value_is_in_objects</span><span class="p">(</span><span class="n">o</span><span class="p">)</span></div>


<div class="viewcode-block" id="MultiFileSelector"><a class="viewcode-back" href="../../Reference_Manual/param.html#param.__init__.MultiFileSelector">[docs]</a><span class="k">class</span> <span class="nc">MultiFileSelector</span><span class="p">(</span><span class="n">ListSelector</span><span class="p">):</span>
    <span class="sd">"""</span>
<span class="sd">    Given a path glob, allows multiple files to be selected from the list of matches.</span>
<span class="sd">    """</span>
    <span class="vm">__slots__</span> <span class="o">=</span> <span class="p">[</span><span class="s1">'path'</span><span class="p">]</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">path</span><span class="o">=</span><span class="s2">""</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">MultiFileSelector</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">default</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">path</span> <span class="o">=</span> <span class="n">path</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">update</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">update</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">objects</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">glob</span><span class="o">.</span><span class="n">glob</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">path</span><span class="p">))</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">default</span> <span class="ow">and</span> <span class="nb">all</span><span class="p">([</span><span class="n">o</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">objects</span> <span class="k">for</span> <span class="n">o</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">default</span><span class="p">]):</span>
            <span class="k">return</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">default</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">objects</span>

<div class="viewcode-block" id="MultiFileSelector.get_range"><a class="viewcode-back" href="../../Reference_Manual/param.html#param.__init__.MultiFileSelector.get_range">[docs]</a>    <span class="k">def</span> <span class="nf">get_range</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">abbreviate_paths</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">path</span><span class="p">,</span><span class="nb">super</span><span class="p">(</span><span class="n">MultiFileSelector</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">get_range</span><span class="p">())</span></div></div>


<div class="viewcode-block" id="Date"><a class="viewcode-back" href="../../Reference_Manual/param.html#param.__init__.Date">[docs]</a><span class="k">class</span> <span class="nc">Date</span><span class="p">(</span><span class="n">Number</span><span class="p">):</span>
    <span class="sd">"""</span>
<span class="sd">    Date parameter of datetime type.</span>
<span class="sd">    """</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">Date</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="n">default</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_check_value</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">val</span><span class="p">):</span>
        <span class="sd">"""</span>
<span class="sd">        Checks that the value is numeric and that it is within the hard</span>
<span class="sd">        bounds; if not, an exception is raised.</span>
<span class="sd">        """</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">allow_None</span> <span class="ow">and</span> <span class="n">val</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">val</span><span class="p">,</span> <span class="n">dt_types</span><span class="p">)</span> <span class="ow">and</span> <span class="ow">not</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">allow_None</span> <span class="ow">and</span> <span class="n">val</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">"Date '</span><span class="si">%s</span><span class="s2">' only takes datetime types."</span><span class="o">%</span><span class="bp">self</span><span class="o">.</span><span class="n">_attrib_name</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_checkBounds</span><span class="p">(</span><span class="n">val</span><span class="p">)</span></div>


<div class="viewcode-block" id="Color"><a class="viewcode-back" href="../../Reference_Manual/param.html#param.__init__.Color">[docs]</a><span class="k">class</span> <span class="nc">Color</span><span class="p">(</span><span class="n">Parameter</span><span class="p">):</span>
    <span class="sd">"""</span>
<span class="sd">    Color parameter defined as a hex RGB string with an optional #</span>
<span class="sd">    prefix.</span>
<span class="sd">    """</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">allow_None</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">Color</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="n">default</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_check_value</span><span class="p">(</span><span class="n">default</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_check_value</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">val</span><span class="p">):</span>
        <span class="k">if</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">allow_None</span> <span class="ow">and</span> <span class="n">val</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">):</span>
            <span class="k">return</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">val</span><span class="p">,</span> <span class="n">String</span><span class="o">.</span><span class="n">basestring</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">"Color '</span><span class="si">%s</span><span class="s2">' only takes a string value."</span><span class="o">%</span><span class="bp">self</span><span class="o">.</span><span class="n">_attrib_name</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">re</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="s1">'^#?(([0-9a-fA-F]</span><span class="si">{2}</span><span class="s1">)</span><span class="si">{3}</span><span class="s1">|([0-9a-fA-F])</span><span class="si">{3}</span><span class="s1">)$'</span><span class="p">,</span> <span class="n">val</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">"Color '</span><span class="si">%s</span><span class="s2">' only accepts valid RGB hex codes."</span>
                             <span class="o">%</span> <span class="bp">self</span><span class="o">.</span><span class="n">_attrib_name</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">__set__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">obj</span><span class="p">,</span><span class="n">val</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_check_value</span><span class="p">(</span><span class="n">val</span><span class="p">)</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">Color</span><span class="p">,</span><span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__set__</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span><span class="n">val</span><span class="p">)</span></div>



<div class="viewcode-block" id="Range"><a class="viewcode-back" href="../../Reference_Manual/param.html#param.__init__.Range">[docs]</a><span class="k">class</span> <span class="nc">Range</span><span class="p">(</span><span class="n">NumericTuple</span><span class="p">):</span>
    <span class="s2">"A numeric range with optional bounds and softbounds"</span>

    <span class="vm">__slots__</span> <span class="o">=</span> <span class="p">[</span><span class="s1">'bounds'</span><span class="p">,</span> <span class="s1">'inclusive_bounds'</span><span class="p">,</span> <span class="s1">'softbounds'</span><span class="p">]</span>


    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">default</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">bounds</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">softbounds</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                 <span class="n">inclusive_bounds</span><span class="o">=</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span><span class="kc">True</span><span class="p">),</span> <span class="o">**</span><span class="n">params</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">bounds</span> <span class="o">=</span> <span class="n">bounds</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">inclusive_bounds</span> <span class="o">=</span> <span class="n">inclusive_bounds</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">softbounds</span> <span class="o">=</span> <span class="n">softbounds</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">Range</span><span class="p">,</span><span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="n">default</span><span class="p">,</span><span class="n">length</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span><span class="o">**</span><span class="n">params</span><span class="p">)</span>


    <span class="k">def</span> <span class="nf">_check</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">val</span><span class="p">):</span>
        <span class="sd">"""</span>
<span class="sd">        Checks that the value is numeric and that it is within the hard</span>
<span class="sd">        bounds; if not, an exception is raised.</span>
<span class="sd">        """</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">allow_None</span> <span class="ow">and</span> <span class="n">val</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">Range</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">_check</span><span class="p">(</span><span class="n">val</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_checkBounds</span><span class="p">(</span><span class="n">val</span><span class="p">)</span>


<div class="viewcode-block" id="Range.get_soft_bounds"><a class="viewcode-back" href="../../Reference_Manual/param.html#param.__init__.Range.get_soft_bounds">[docs]</a>    <span class="k">def</span> <span class="nf">get_soft_bounds</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">"""</span>
<span class="sd">        For each soft bound (upper and lower), if there is a defined bound (not equal to None)</span>
<span class="sd">        then it is returned, otherwise it defaults to the hard bound. The hard bound could still be None.</span>
<span class="sd">        """</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">bounds</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">hl</span><span class="p">,</span><span class="n">hu</span><span class="o">=</span><span class="p">(</span><span class="kc">None</span><span class="p">,</span><span class="kc">None</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">hl</span><span class="p">,</span><span class="n">hu</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">bounds</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">softbounds</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">sl</span><span class="p">,</span><span class="n">su</span><span class="o">=</span><span class="p">(</span><span class="kc">None</span><span class="p">,</span><span class="kc">None</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">sl</span><span class="p">,</span><span class="n">su</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">softbounds</span>


        <span class="k">if</span> <span class="n">sl</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span> <span class="n">l</span> <span class="o">=</span> <span class="n">hl</span>
        <span class="k">else</span><span class="p">:</span>          <span class="n">l</span> <span class="o">=</span> <span class="n">sl</span>

        <span class="k">if</span> <span class="n">su</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span> <span class="n">u</span> <span class="o">=</span> <span class="n">hu</span>
        <span class="k">else</span><span class="p">:</span>          <span class="n">u</span> <span class="o">=</span> <span class="n">su</span>

        <span class="k">return</span> <span class="p">(</span><span class="n">l</span><span class="p">,</span><span class="n">u</span><span class="p">)</span></div>


    <span class="k">def</span> <span class="nf">rangestr</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">vmin</span><span class="p">,</span> <span class="n">vmax</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">bounds</span>
        <span class="n">incmin</span><span class="p">,</span> <span class="n">incmax</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">inclusive_bounds</span>
        <span class="n">incmin</span> <span class="o">=</span> <span class="s1">'['</span> <span class="k">if</span> <span class="n">incmin</span> <span class="k">else</span> <span class="s1">'('</span>
        <span class="n">incmax</span> <span class="o">=</span> <span class="s1">']'</span> <span class="k">if</span> <span class="n">incmax</span> <span class="k">else</span> <span class="s1">')'</span>
        <span class="k">return</span> <span class="s1">'</span><span class="si">%s%s</span><span class="s1">, </span><span class="si">%s%s</span><span class="s1">'</span> <span class="o">%</span> <span class="p">(</span><span class="n">incmin</span><span class="p">,</span> <span class="n">vmin</span><span class="p">,</span> <span class="n">vmax</span><span class="p">,</span> <span class="n">incmax</span><span class="p">)</span>


    <span class="k">def</span> <span class="nf">_checkBounds</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">val</span><span class="p">):</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">bounds</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">vmin</span><span class="p">,</span><span class="n">vmax</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">bounds</span>
            <span class="n">incmin</span><span class="p">,</span><span class="n">incmax</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">inclusive_bounds</span>
            <span class="k">for</span> <span class="n">bound</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">([</span><span class="s1">'lower'</span><span class="p">,</span> <span class="s1">'upper'</span><span class="p">],</span> <span class="n">val</span><span class="p">):</span>
                <span class="n">too_low</span> <span class="o">=</span> <span class="p">(</span><span class="n">vmin</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span><span class="n">v</span> <span class="o">&lt;</span> <span class="n">vmin</span> <span class="k">if</span> <span class="n">incmin</span> <span class="k">else</span> <span class="n">v</span> <span class="o">&lt;=</span> <span class="n">vmin</span><span class="p">)</span>
                <span class="n">too_high</span> <span class="o">=</span> <span class="p">(</span><span class="n">vmax</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span><span class="n">v</span> <span class="o">&gt;</span> <span class="n">vmax</span> <span class="k">if</span> <span class="n">incmax</span> <span class="k">else</span> <span class="n">v</span> <span class="o">&gt;=</span> <span class="n">vmax</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">too_low</span> <span class="ow">or</span> <span class="n">too_high</span><span class="p">:</span>
                    <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">"Parameter '</span><span class="si">%s</span><span class="s2">' </span><span class="si">%s</span><span class="s2"> bound must be in range </span><span class="si">%s</span><span class="s2">"</span>
                                     <span class="o">%</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_attrib_name</span><span class="p">,</span> <span class="n">bound</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">rangestr</span><span class="p">()))</span></div>


<div class="viewcode-block" id="DateRange"><a class="viewcode-back" href="../../Reference_Manual/param.html#param.__init__.DateRange">[docs]</a><span class="k">class</span> <span class="nc">DateRange</span><span class="p">(</span><span class="n">Range</span><span class="p">):</span>
    <span class="sd">"""</span>
<span class="sd">    A date range specified as (start_date, end_date).</span>

<span class="sd">    Dates must be specified as datetime-like types (see</span>
<span class="sd">    param.dt_types).</span>
<span class="sd">    """</span>
    <span class="k">def</span> <span class="nf">_check</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">val</span><span class="p">):</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">allow_None</span> <span class="ow">and</span> <span class="n">val</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span>

        <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="n">val</span><span class="p">:</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">dt_types</span><span class="p">):</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">"DateRange '</span><span class="si">%s</span><span class="s2">' only takes datetime types: </span><span class="si">%s</span><span class="s2">"</span><span class="o">%</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_attrib_name</span><span class="p">,</span><span class="n">val</span><span class="p">))</span>

        <span class="n">start</span><span class="p">,</span> <span class="n">end</span> <span class="o">=</span> <span class="n">val</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">end</span> <span class="o">&gt;=</span> <span class="n">start</span><span class="p">:</span>
           <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">"DateRange '</span><span class="si">%s</span><span class="s2">': end date </span><span class="si">%s</span><span class="s2"> is before start date </span><span class="si">%s</span><span class="s2">."</span><span class="o">%</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_attrib_name</span><span class="p">,</span><span class="n">val</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span><span class="n">val</span><span class="p">[</span><span class="mi">0</span><span class="p">]))</span>

        <span class="c1"># Calling super(DateRange, self)._check(val) would also check</span>
        <span class="c1"># values are numeric, which is redundant, so just call</span>
        <span class="c1"># _checkBounds().</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_checkBounds</span><span class="p">(</span><span class="n">val</span><span class="p">)</span></div>
</pre>
    </div>
   </div>
  </div>
  <!-- END MAIN BODY OF DOCS ––––––––––––– -->
  <footer class="footer">
   <div class="footer-links">
    <ul>
     <li>
      <span class="footer-title">
       Links
      </span>
     </li>
     <li>
      <a href="../../Reference_Manual/param.html">
       API
      </a>
     </li>
     <li>
      <a href="../../About.html">
       About
      </a>
     </li>
    </ul>
    <ul>
     <li>
      <span class="footer-title">
       Join Us
      </span>
     </li>
     <li>
      <a href="//gitter.im/ioam/holoviews">
       Gitter
      </a>
     </li>
     <li>
      <a href="//github.com/ioam/param">
       Github
      </a>
     </li>
    </ul>
    <ul class="copyright">
     <li>
      © 2005-2018, PyViz authors
     </li>
    </ul>
   </div>
  </footer>
  <!-- Google Analytics -->
  <script>
   (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-61554933-1', 'auto');
  ga('send', 'pageview');
  </script>
  <!-- MathJax Config -->
  <script type="text/x-mathjax-config">
   MathJax.Hub.Config({
  tex2jax: {inlineMath: [['$','$'], ['\\(','\\)']]}
});
  </script>
  <!-- End Document
  –––––––––––––––––––––––––––––––––––––––––––––––––– -->
 </body>
</html>